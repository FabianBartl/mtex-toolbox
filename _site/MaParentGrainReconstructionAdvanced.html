<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="description" content="">
<meta name="keywords" content="">


<title>Martensite Parent Grain Reconstruction | MTEX</title>

<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">

<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme.css">
<link rel="stylesheet" href="css/theme-mtex.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<!-- Favicons -->
<link rel="apple-touch-icon" type="image/png" sizes="100x100" href="images/favicons/favicon.png">
<link rel="icon" type="image/png" sizes="100x100" href="images/favicons/favicon.png">
<link rel="manifest" href="images/favicons/manifest.json">
<meta name="msapplication-TileColor" content="#149983">
<meta name="msapplication-TileImage" size="100x100" type="image/png" content="images/favicons/favicon.png">
<meta name="theme-color" content="#149983">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://localhost:4000/feed.xml">

<!-- enable MathJax
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
          inlineMath: [['$','$']]
      }
  });
</script>-->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>


    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    
</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-lg navbar-brand" href="index"><img src="images/icons/MTEX_100x67px.png"></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <br><br>
            <ul class="nav navbar-nav navbar-right">

                <!-- topnav -->
                
                
                    
                        
                        
                            <li><a href="index">Home</a></li>
                        
                    
                        
                        
                            <li><a href="download">Download</a></li>
                        
                    
                        
                        
                            <li><a href="Documentation">Documentation</a></li>
                        
                    
                        
                        
                            <li><a href="function_reference">Function Reference</a></li>
                        
                    
                        
                        
                            <li><a href="examples">Examples</a></li>
                        
                    
                        
                        
                            <li><a href="workshop24">Workshops</a></li>
                        
                    
                        
                        
                            <li><a href="people">People</a></li>
                        
                    
                        
                        
                            <li><a href="search"><i class="fa fa-search"></i></a></li>
                        
                    
                

                
            </ul>
        </div>
    </div>
    <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">Topics </li>
  
  
  
  <li>
      <a class="no_icon" href="#">Tutorials</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="EBSDTutorial.html">EBSD</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="GrainTutorial.html">Grains</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="PoleFigureTutorial.html">Pole Figure Data</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ODFTutorial.html">ODFs</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ImportFromVPSC.html">Import from VPSC</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">General Concepts</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="MTEXScripts.html">MTEX Scripts</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ListsAndIndexing.html">Lists and Indexing</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="GeneralConceptsConfiguration.html">Configuration</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="GeneralConceptsOptions.html">Options</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="Properties.html">Properties</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="DensityEstimation.html">Density Estimation</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="OptimalKernel.html">Optimal Kernel Selection</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ClusterDemo.html">Cluster demo</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">Vectors</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="VectorsDefinition.html">Definition</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="VectorsImport.html">Import</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="VectorsExport.html">Export</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="VectorsOperations.html">Operations</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="VectorsDensityEstimation.html">Density Estimation</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="VectorsAxes.html">Axes</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="VectorGrids.html">Spherical Grids</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">Rotations</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="RotationDefinition.html">Definition</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="RotationImproper.html">Improper Rotations</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="RotationOperations.html">Operations</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="RotationPlotting.html">Plotting</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="RotationImport.html">Import</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="RotationExport.html">Export</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="RotationFibre.html">Fibres</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="RotationSpinTensor.html">Spin Tensor</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">Crystal Geometry</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="CrystalSymmetries.html">Crystal Symmetries</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="CrystalDirections.html">Miller Indicies</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="CrystalOperations.html">Operations</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="CrystalReferenceSystem.html">Reference System</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SymmetryAlignment.html">Crystal Axes Alignment</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="CrystalShapes.html">Crystal Shapes</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="CrystalShapeSmorf.html">Advanced Crystal Shapes</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="FundamentalSector.html">Fundamental Sector</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="QuasiCrystals.html">Quasi Symmetries</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">Orientations</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="OrientationDefinition.html">Definition</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="DefinitionAsCoordinateTransform.html">Theory</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="OrientationSymmetry.html">Symmetry</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="OrientationStandard.html">Standard Orientations</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="MTEXvsBungeConvention.html">MTEX vs. Bunge Convention</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="OrientationPoleFigure.html">Pole Figures</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="OrientationInversePoleFigure.html">Inverse Pole Figure</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="OrientationVisualization3d.html">3D Plots</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="OrientationVisualizationSections.html">Section Plots</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="OrientationFundamentalRegion.html">Fundamenal Region</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SpecimenSymmetry.html">Specimen Symmetry</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="OrientationGrid.html">Grids</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="OrientationFibre.html">Fibres</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="OrientationImport.html">Import</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="OrientationExport.html">Export</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="OrientationEmbeddings.html">Embeddings</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">Misorientations</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="MisorientationTheory.html">Theory</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="Twinning.html">Twinning</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="MisorientationDistributionFunction.html">Misorientation Distribution Function</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="AxisDistributionFunction.html">Axis Distribution Function</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="AngleDistributionFunction.html">Angle Distribution Function</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">ODF</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="ODFTheory.html">Theory</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ODFModeling.html">Calculations</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ODFPlot.html">Plot</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ODFPoleFigure.html">Pole Figures</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ODFInversePoleFigure.html">Inverse Pole Figures</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EulerAngleSections.html">Euler Angle Sections</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SigmaSections.html">Sigma Sections</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ODFComponents.html">Components</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ODFCharacteristics.html">Properties</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="RadialODFs.html">Radial ODF</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="FibreODFs.html">Fibre ODF</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="BinghamODFs.html">Bingham ODF</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SO3FunHarmonicRepresentation.html">Series Expansion</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ODFImport.html">Import</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ODFExport.html">Export</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="RandomSampling.html">Random Sampling</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="DensityEstimation.html">Density Estimation</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="DetectionOfSampleSymmetry.html">Sample Symmetry</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ODFShapes.html">Shapes</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">Pole Figures</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="PoleFigureImport.html">Import</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="PoleFigurePlot.html">Plot</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="PoleFigureCorrection.html">Modify</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="PoleFigure2ODF.html">ODF Reconstruction</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="PoleFigureSimulation.html">Simulation</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="PoleFigure2ODFAmbiguity.html">The Gost Effect</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="PoleFigure2ODFGhostCorrection.html">Ghost Correction</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="PoleFigureSantaFe.html">Santa Fe Example</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="PoleFigureDubna.html">Dubna Example</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="PoleFigureExport.html">Export</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">EBSD</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="EBSDImport.html">Import</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDReferenceFrame.html">Reference Frame</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDPlotting.html">Plot</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDIPFMap.html">IPF Maps</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDOrientationPlots.html">Orientation Plots</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDSelect.html">Select</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDIndex.html">Select by Index</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDOrientationAnalysis.html">Orientation Analysis</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="GrainReconstruction.html">Grain Reconstruction</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDGrid.html">Square and Hex Grids</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDDenoising.html">Denoising</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDFilling.html">Filling Missing Data</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDInter.html">Regridding and Interpolation</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSD2ODF.html">ODF Estimation</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDOrientationPlots.html">Orientation Plots</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDSharpPlot.html">Sharp Color Keys</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDAdvancedMaps.html">Advanced Plotting</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDKAM.html">KAM</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDGROD.html">Mis2Mean / GROD</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDProfile.html">Profiles</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDSimulation.html">Simulation</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EBSDExport.html">Export</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">Grains</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="GrainReconstruction.html">Reconstruction</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="GrainSpatialPlots.html">Plot</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SelectingGrains.html">Select</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ShapeParameters.html">Shape Parameters</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EllipseBasedParameters.html">Ellipse Fitting</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="HullBasedParameters.html">Convex Hull Parameters</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ProjectionBasedParameters.html">Projection Parameters</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="GrainOrientationParameters.html">Orientation Parameters</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="GrainNeighbours.html">Neighbours</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="GrainMerge.html">Merge</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="GrainReconstructionAdvanced.html">Advanced Reconstruction</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="GrainExport.html">Export</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="NeperInterface.html">Neper Interface</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">Grain Boundaries</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="BoundarySelect.html">Select</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="BoundaryPlots.html">Plot</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="BoundaryProperties.html">Properties</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SubGrainBoundaries.html">Subgrain Boundaries</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="TiltAndTwistBoundaries.html">Twist and Tilt</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="CSLBoundaries.html">CSL</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="BoundaryCurvature.html">Curvature</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="GrainSmoothing.html">Smoothing</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="TwinningBoundaries.html">Twinning</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="TriplePoints.html">Triple Points</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="BoundaryIntersections.html">Intersections</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="BoundaryNormalDistribution.html">Distribution</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">Tensors</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="TensorDefinition.html">Definition</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="TensorImport.html">Import</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="TensorArithmetics.html">Arithmethics</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="TensorVisualisation.html">Plotting</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="TensorAverage.html">Averages</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="PiezoElectricity.html">Piezo Electricity</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="BirefringenceDemo.html">Birefringence</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="MagneticAnisotropy.html">Magnetic Anisotropy</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">Elasticity</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="IsotropicTheory.html">Isotropic Theory</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="AnisotropicTheory.html">Anisotropic Elasticity</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="WaveVelocities.html">Wave Velocities</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="CPOSeismicProperties.html">Plot seismic wave velocities and polarization directions for aggregates</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">Plasticity</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="SlipSystems.html">Slip Systems</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SchmidtFactor.html">The Schmid Factor</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="TaylorModel.html">Taylor Model</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="TaylorHex.html">Texture evolution in rolled magnesium during uniaxial tension</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SachsModel.html">Sachs Model</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SingleSlipModel.html">Sigle Slip Model</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SlipTransmission.html">Slip Transmission</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="GND.html">Geometrically Necessary Dislocations</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="VPSCImport.html">Import from VPSC</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="TextureEvolution.html">Texture Evolution</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="TaylorHex.html">Texture evolution in rolled magnesium during uniaxial tension</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">Phase Transitions</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="ParentChildVariants.html">Parent Child Variants</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="MartensiteVariants.html">Martensite Variants</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="TiBetaReconstruction.html">Parent Beta Reconstruction</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="MaParentGrainReconstruction.html">Parent Austenite Reconstruction</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="TransformationTexture.html">Transformation Texture</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="GrainGraphBasedReconstruction.html">Grain Graph Based Reconstruction</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="TriplePointBasedReconstruction.html">Triple Point Based Reconstruction</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="LowLevelParentGrainReconstruction.html">Low Level Reconstruction</a></li>
          
          
          
          
          
          
          <li class="active"><a class="no_icon" href="MaParentGrainReconstructionAdvanced.html">Low Level Reconstruction 2</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">Spherical Functions</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="S2FunConcept.html">Concept</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="S2FunOperations.html">Operations</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="S2FunPlotting.html">Plotting</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="S2FunApproximationInterpolation.html">Approximation and Interpolation</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="S2FunHarmonicRepresentation.html">Harmonic Representation</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="S2FunBingham.html">Bingham Distribution</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="S2FunRadon.html">Radon Transform</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="S2FunVectorField.html">Vector Field</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="S2FunAxisField.html">Axis Field</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="S2FunSym.html">Symmetric Function</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="S2FunMultivariate.html">Multivariate Functions</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="S2Kernels.html">Spherical Kernel Functions</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SphericalHarmonics.html">Spherical Harmonics</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">Orientation Functions</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="SO3FunConcept.html">Concept</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SO3FunDefinition.html">Definition</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SO3FunOperations.html">Operations</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ODFPlot.html">Plotting</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="EulerAngleSections.html">Euler Angle Sections</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SigmaSections.html">Sigma Sections</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SO3FunApproximationInterpolation.html">Approximation and Interpolation</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SO3FunHarmonicRepresentation.html">Harmonic Representation</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="RadialODFs.html">Radial Basis Functions</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="FibreODFs.html">Fibre Functions</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="BinghamODFs.html">Bingham ODF</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ODFImport.html">Import</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ODFExport.html">Export</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SO3FunVectorField.html">Vector Field</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SO3FunSymmetricFunctions.html">Symmetry</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SO3FunMultivariate.html">Multivariate Functions</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SO3Kernels.html">Rotational Kernel Functions</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="WignerFunctions.html">Wigner-D Functions</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a class="no_icon" href="#">Plotting</a>
      <ul>
          
          
          
          <li><a class="no_icon" href="PlotTypes.html">Plot Types</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="AxesAlignment.html">Axes Alignment</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="CombinedPlots.html">Combined Plots</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="Multiplot.html">Multiplot</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="Annotations.html">Annotations</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="PlottingExport.html">Export</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="SphericalProjections.html">Spherical Projections</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="Legends.html">Legends</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ColorMaps.html">Color Mapping</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="ContourPlots.html">Contour Plots</a></li>
          
          
          
          
          
          
          <li><a class="no_icon" href="TransparencyDemo.html">Transparencys</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a class="no_icon" href="#" id="collapseAll">Collapse All</a> | <a class="no_icon" href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            
    <div class="post-header">
        <h1 class="post-title-main">Martensite Parent Grain Reconstruction</h1>
    </div>


<div class="post-content">

    

    


    

        <html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Martensite Parent Grain Reconstruction</title><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.source" content="script_MaParentGrainReconstructionAdvanced.m"></head><body><font size="2"><a href="https://github.com/mtex-toolbox/mtex/blob/develop/doc/PhaseTransistions/MaParentGrainReconstructionAdvanced.m">
    edit page</a></font><div><!--introduction--><!--/introduction--><p>This script demonstrates the tools MTEX offers to reconstruct a parent austenite phase from a measured martensite phase. Most of the ideas are from <a href="https://www.researchgate.net/deref/http%3A%2F%2Fdx.doi.org%2F10.1007%2Fs11661-018-4904-9?_sg%5B0%5D=gRJGzFvY4PyFk-FFoOIj2jDqqumCsy3e8TU6qDnJoVtZaeUoXjzpsGmpe3TDKsNukQYQX9AtKGniFzbdpymYvzYwhg.5jfOl5Ohgg7pW_6yACRXN3QiR-oTn8UsxZjTbJoS_XqwSaaB7r8NgifJyjSES2iXP6iOVx57sy8HC4q2XyZZaA">Crystallography, Morphology, and Martensite Transformation of Prior Austenite in Intercritically Annealed High-Aluminum Steel</a> by Tuomo Nyyss&ouml;nen. We shall use the following sample data set.</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="c1">% load the data</span>
<span class="n">mtexdata</span> <span class="n">martensite</span>
<span class="n">plotx2east</span>

<span class="c1">% extract fcc and bcc symmetries</span>
<span class="n">csBCC</span> <span class="o">=</span> <span class="n">ebsd</span><span class="o">.</span><span class="n">CSList</span><span class="p">{</span><span class="mi">2</span><span class="p">};</span> <span class="c1">% austenite bcc:</span>
<span class="n">csFCC</span> <span class="o">=</span> <span class="n">ebsd</span><span class="o">.</span><span class="n">CSList</span><span class="p">{</span><span class="mi">3</span><span class="p">};</span> <span class="c1">% martensite fcc:</span>

<span class="c1">% grain reconstruction</span>
<span class="p">[</span><span class="n">grains</span><span class="p">,</span><span class="n">ebsd</span><span class="o">.</span><span class="n">grainId</span><span class="p">]</span> <span class="o">=</span> <span class="n">calcGrains</span><span class="p">(</span><span class="n">ebsd</span><span class="p">(</span><span class="s1">'indexed'</span><span class="p">),</span><span class="s1">'angle'</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="nb">degree</span><span class="p">);</span>

<span class="c1">% remove small grains</span>
<span class="n">ebsd</span><span class="p">(</span><span class="n">grains</span><span class="p">(</span><span class="n">grains</span><span class="o">.</span><span class="n">grainSize</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">))</span> <span class="o">=</span> <span class="p">[];</span>

<span class="c1">% reidentify grains with small grains removed:</span>
<span class="p">[</span><span class="n">grains</span><span class="p">,</span><span class="n">ebsd</span><span class="o">.</span><span class="n">grainId</span><span class="p">]</span> <span class="o">=</span> <span class="n">calcGrains</span><span class="p">(</span><span class="n">ebsd</span><span class="p">(</span><span class="s1">'indexed'</span><span class="p">),</span><span class="s1">'angle'</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="nb">degree</span><span class="p">);</span>

<span class="c1">% plot the data and the grain boundaries</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">ebsd</span><span class="p">(</span><span class="s1">'Iron bcc'</span><span class="p">),</span><span class="n">ebsd</span><span class="p">(</span><span class="s1">'Iron bcc'</span><span class="p">)</span><span class="o">.</span><span class="n">orientations</span><span class="p">,</span><span class="s1">'figSize'</span><span class="p">,</span><span class="s1">'large'</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">on</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">grains</span><span class="o">.</span><span class="nb">boundary</span><span class="p">,</span><span class="s1">'linewidth'</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">off</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-plaintext" data-lang="plaintext">ebsd = EBSD
 
 Phase  Orientations         Mineral         Color  Symmetry  Crystal reference frame
     0   92415 (27%)      notIndexed                                                 
     1  251187 (73%)  Iron bcc (old)  LightSkyBlue       432                         
 
 Properties: bands, bc, bs, error, mad, reliabilityindex, x, y
 Scan unit : um</code></pre></figure>
<center>
<img class="inline" src="images/MaParentGrainReconstructionAdvanced_01.png" alt="" />

</center><h2 id="2">Determine the parent child orientation relationship</h2><p>It is well known that the phase transformation from austenite to martensite is not described by a fixed orientation relationship. In fact, the actual orientation relationship needs to be determined for each sample individualy. Here, we used the iterative method proposed by Tuomo Nyyss&ouml;nen and implemented in the function <a href="calcParent2Child.html"><code class="language-plaintext highlighter-rouge">calcParent2Child</code></a> that starts at an initial guess of the orientation relation ship and iterates towards the true orientation relationship.</p><p>Here we use as the initial guess the Kurdjumov Sachs orientation relationship</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="c1">% initial gues is Kurdjumov Sachs</span>
<span class="n">KS</span> <span class="o">=</span> <span class="n">orientation</span><span class="o">.</span><span class="n">KurdjumovSachs</span><span class="p">(</span><span class="n">csFCC</span><span class="p">,</span><span class="n">csBCC</span><span class="p">);</span></code></pre></figure>
<p>The function <a href="calcParent2Child.html"><code class="language-plaintext highlighter-rouge">calcParent2Child</code></a> requires as input a list of child to child misorientations or, equivalently, a two column matrix of child orientations. Here we go with the second option and setup this two column orientation matrix from the mean orientations of neighbouring grains which can be found using the command <a href="grain2d.neighbours.html"><code class="language-plaintext highlighter-rouge">neighbours</code></a></p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="c1">% get neighbouring grain pairs</span>
<span class="n">grainPairs</span> <span class="o">=</span> <span class="n">grains</span><span class="o">.</span><span class="nb">neighbors</span><span class="p">;</span>

<span class="c1">% ignore pairs with misorientation angle smaller then 5 degree</span>
<span class="n">mori</span> <span class="o">=</span> <span class="n">grains</span><span class="p">(</span><span class="n">grainPairs</span><span class="p">)</span><span class="o">.</span><span class="n">meanOrientation</span><span class="p">;</span>
<span class="n">grainPairs</span><span class="p">(</span><span class="nb">angle</span><span class="p">(</span><span class="n">mori</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">mori</span><span class="p">(:,</span><span class="mi">2</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="o">*</span><span class="nb">degree</span><span class="p">,:)</span> <span class="o">=</span> <span class="p">[];</span>

<span class="c1">% compute an optimal parent to child orientation relationship</span>
<span class="p">[</span><span class="n">fcc2bcc</span><span class="p">,</span> <span class="n">fit</span><span class="p">]</span> <span class="o">=</span> <span class="n">calcParent2Child</span><span class="p">(</span><span class="n">grains</span><span class="p">(</span><span class="n">grainPairs</span><span class="p">)</span><span class="o">.</span><span class="n">meanOrientation</span><span class="p">,</span><span class="n">KS</span><span class="p">);</span></code></pre></figure>
<p>Beside the optimized parent to child orientation relationship the command <a href="calcParent2Child.html"><code class="language-plaintext highlighter-rouge">calcParent2Child</code></a> returns as a second output argument the misfit between all grain to grain misorientations and the theoretical child to child misorientations. In fact, the algorithm assumes that the majority of all boundary misorientations are child to child misorientations and finds the parent to child orientations relationship by minimizing this misfit. The following histogram displays the distribution of the misfit over all grain to grain misorientations.</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="nb">close</span> <span class="nb">all</span>
<span class="nb">histogram</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="p">/</span><span class="nb">degree</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'disorientation angle'</span><span class="p">)</span></code></pre></figure>
<center>
<img class="inline" src="images/MaParentGrainReconstructionAdvanced_02.png" alt="" />

</center><p>We may also colorize the grain boundaries according to this misfit. To this end we first compute the relationship between pairs of grains <code class="language-plaintext highlighter-rouge">grainPairs</code> and the boundary segments stored in <code class="language-plaintext highlighter-rouge">grains.boundary</code> using the command <a href="grainBoundary.selectByGrainId.html"><code class="language-plaintext highlighter-rouge">selectByGrainId</code></a></p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="p">[</span><span class="n">gB</span><span class="p">,</span><span class="n">pairId</span><span class="p">]</span> <span class="o">=</span> <span class="n">grains</span><span class="o">.</span><span class="nb">boundary</span><span class="o">.</span><span class="n">selectByGrainId</span><span class="p">(</span><span class="n">grainPairs</span><span class="p">);</span></code></pre></figure>
<p>abd then pass the variable <code class="language-plaintext highlighter-rouge">fit</code> as second input argument to the <a href="grainBoundary.plot.html"><code class="language-plaintext highlighter-rouge">plot</code></a> command</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="nb">plot</span><span class="p">(</span><span class="n">ebsd</span><span class="p">(</span><span class="s1">'Iron bcc'</span><span class="p">),</span><span class="n">ebsd</span><span class="p">(</span><span class="s1">'Iron bcc'</span><span class="p">)</span><span class="o">.</span><span class="n">orientations</span><span class="p">,</span><span class="s1">'figSize'</span><span class="p">,</span><span class="s1">'large'</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">on</span><span class="p">;</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">gB</span><span class="p">,</span><span class="n">fit</span><span class="p">(</span><span class="n">pairId</span><span class="p">)</span> <span class="o">.</span><span class="p">/</span> <span class="nb">degree</span><span class="p">,</span><span class="s1">'linewidth'</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s1">'smooth'</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">off</span>

<span class="n">mtexColorMap</span> <span class="n">LaboTeX</span>
<span class="n">mtexColorbar</span>

<span class="n">setColorRange</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span></code></pre></figure>
<center>
<img class="inline" src="images/MaParentGrainReconstructionAdvanced_03.png" alt="" />

</center><p>We observe that the boundary segments with a large misfit form large grain shapes which we want to identify in the next steps as the parent grains.</p><h2 id="8">Create a similarity matrix</h2><p>Next we set up a adjacency matrix <code class="language-plaintext highlighter-rouge">A</code> that describes the probability that two neighbouring grains belong to the same parent grains. This probability is computed from the misfit of the misorientation between two child grains to the theoretical child to child misorientation. More precisely, we model the probability by a cumulative Gaussian distribution with the mean value <code class="language-plaintext highlighter-rouge">threshold</code> which describes the misfit at which the probability is exactly 50 percent and the standard deviation <code class="language-plaintext highlighter-rouge">tol</code></p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="n">omega</span> <span class="o">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="nb">degree</span><span class="p">;</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="nb">degree</span><span class="p">;</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">1.5</span><span class="o">*</span><span class="nb">degree</span><span class="p">;</span>

<span class="nb">close</span> <span class="nb">all</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">omega</span><span class="o">.</span><span class="p">/</span><span class="nb">degree</span><span class="p">,</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nb">erf</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">omega</span> <span class="o">-</span> <span class="n">threshold</span><span class="p">)</span><span class="o">.</span><span class="p">/</span><span class="n">tol</span><span class="p">)),</span><span class="s1">'linewidth'</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'misfit in degree'</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'probability'</span><span class="p">)</span></code></pre></figure>
<center>
<img class="inline" src="images/MaParentGrainReconstructionAdvanced_04.png" alt="" />

</center><p>The above diagram describes the probability distribution as a function of the misfit. After filling the matrix <code class="language-plaintext highlighter-rouge">A</code> with these probabilities</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="c1">% compute the probabilities</span>
<span class="n">prob</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nb">erf</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">fit</span> <span class="o">-</span> <span class="n">threshold</span><span class="p">)</span><span class="o">.</span><span class="p">/</span><span class="n">tol</span><span class="p">));</span>

<span class="c1">% the corresponding similarity matrix</span>
<span class="n">A</span> <span class="o">=</span> <span class="nb">sparse</span><span class="p">(</span><span class="n">grainPairs</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">grainPairs</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span><span class="n">prob</span><span class="p">,</span><span class="nb">length</span><span class="p">(</span><span class="n">grains</span><span class="p">),</span><span class="nb">length</span><span class="p">(</span><span class="n">grains</span><span class="p">));</span></code></pre></figure>
<p>we can split it into clusters using the command <a href="calcCluster.html"><code class="language-plaintext highlighter-rouge">calcCluster</code></a> which implements the <a href="https://micans.org/mcl">Markovian clustering algorithm</a>. Here an important parameter is the so called inflation power, which controls the size of the clusters.</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="n">p</span> <span class="o">=</span> <span class="mf">1.6</span><span class="p">;</span> <span class="c1">% inflation power:</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">mclComponents</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">p</span><span class="p">);</span></code></pre></figure>
<p>Each connected component of the resulting adjacency matrix describes one parent grain. Hence, we can use this adjacency matrix to merge child grains into parent grains by the command <a href="graind2d.merge.html"><code class="language-plaintext highlighter-rouge">merge</code></a>.</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="c1">% merge grains according to the adjacency matrix A</span>
<span class="p">[</span><span class="n">parentGrains</span><span class="p">,</span> <span class="n">parentId</span><span class="p">]</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">grains</span><span class="p">,</span><span class="n">A</span><span class="p">);</span>

<span class="c1">% ensure grainId in parentEBSD is set up correctly with parentGrains</span>
<span class="n">parentEBSD</span> <span class="o">=</span> <span class="n">ebsd</span><span class="p">;</span>
<span class="n">parentEBSD</span><span class="p">(</span><span class="s1">'indexed'</span><span class="p">)</span><span class="o">.</span><span class="n">grainId</span> <span class="o">=</span> <span class="n">parentId</span><span class="p">(</span><span class="n">ebsd</span><span class="p">(</span><span class="s1">'indexed'</span><span class="p">)</span><span class="o">.</span><span class="n">grainId</span><span class="p">);</span></code></pre></figure>
<p>Let's visualize the first result. Note, that at this stage it is not important to have the parent grains already at their optimal size. Similarly orientated grains can be merged later on.</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="nb">plot</span><span class="p">(</span><span class="n">ebsd</span><span class="p">(</span><span class="s1">'Iron bcc'</span><span class="p">),</span><span class="n">ebsd</span><span class="p">(</span><span class="s1">'Iron bcc'</span><span class="p">)</span><span class="o">.</span><span class="n">orientations</span><span class="p">,</span><span class="s1">'figSize'</span><span class="p">,</span><span class="s1">'large'</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">on</span><span class="p">;</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">parentGrains</span><span class="o">.</span><span class="nb">boundary</span><span class="p">,</span><span class="s1">'linewidth'</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">off</span></code></pre></figure>
<center>
<img class="inline" src="images/MaParentGrainReconstructionAdvanced_05.png" alt="" />

</center><h2 id="13">Compute parent grain orientations</h2><p>In the next step we compute for each parent grain its parent austenite orientation. This can be done usig the command <a href="calcParent.html"><code class="language-plaintext highlighter-rouge">calcParent</code></a>. Note, that we ensure that at least two child grains have been merged and that the misfit is smaller than 5 degree.</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="c1">% the measured child orientations</span>
<span class="n">childOri</span> <span class="o">=</span> <span class="n">grains</span><span class="p">(</span><span class="s1">'Iron bcc'</span><span class="p">)</span><span class="o">.</span><span class="n">meanOrientation</span><span class="p">;</span>

<span class="c1">% the parent orientation we are going to compute</span>
<span class="n">parentOri</span> <span class="o">=</span> <span class="n">orientation</span><span class="o">.</span><span class="n">nan</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">parentId</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="n">fcc2bcc</span><span class="o">.</span><span class="n">CS</span><span class="p">);</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">inf</span><span class="p">(</span><span class="nb">size</span><span class="p">(</span><span class="n">parentOri</span><span class="p">));</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">grains</span><span class="p">(</span><span class="s1">'Iron bcc'</span><span class="p">)</span><span class="o">.</span><span class="n">grainSize</span><span class="p">;</span>

<span class="c1">% loop through all parent grains</span>
<span class="k">for</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="nb">max</span><span class="p">(</span><span class="n">parentId</span><span class="p">)</span>
  <span class="k">if</span> <span class="nb">nnz</span><span class="p">(</span><span class="n">parentId</span><span class="o">==</span><span class="n">k</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="c1">% compute the parent orientation from the child orientations</span>
    <span class="p">[</span><span class="n">parentOri</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">fit</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="n">calcParent</span><span class="p">(</span><span class="n">childOri</span><span class="p">(</span><span class="n">parentId</span><span class="o">==</span><span class="n">k</span><span class="p">),</span> <span class="n">fcc2bcc</span><span class="p">,</span><span class="s1">'weights'</span><span class="p">,</span><span class="n">weights</span><span class="p">((</span><span class="n">parentId</span><span class="o">==</span><span class="n">k</span><span class="p">)));</span>
  <span class="k">end</span>
  <span class="nb">progress</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">parentId</span><span class="p">));</span>
<span class="k">end</span>

<span class="c1">% update mean orientation of the parent grains</span>
<span class="n">parentGrains</span><span class="p">(</span><span class="n">fit</span><span class="o">&lt;</span><span class="mi">5</span><span class="o">*</span><span class="nb">degree</span><span class="p">)</span><span class="o">.</span><span class="n">meanOrientation</span> <span class="o">=</span> <span class="n">parentOri</span><span class="p">(</span><span class="n">fit</span><span class="o">&lt;</span><span class="mi">5</span><span class="o">*</span><span class="nb">degree</span><span class="p">);</span>
<span class="n">parentGrains</span> <span class="o">=</span> <span class="n">parentGrains</span><span class="o">.</span><span class="n">update</span><span class="p">;</span>

<span class="c1">% merge grains with similar orientation</span>
<span class="p">[</span><span class="n">parentGrains</span><span class="p">,</span> <span class="n">mergeId</span><span class="p">]</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">parentGrains</span><span class="p">,</span><span class="s1">'threshold'</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="nb">degree</span><span class="p">);</span>
<span class="n">parentEBSD</span><span class="p">(</span><span class="s1">'indexed'</span><span class="p">)</span><span class="o">.</span><span class="n">grainId</span> <span class="o">=</span> <span class="n">mergeId</span><span class="p">(</span><span class="n">parentEBSD</span><span class="p">(</span><span class="s1">'indexed'</span><span class="p">)</span><span class="o">.</span><span class="n">grainId</span><span class="p">);</span></code></pre></figure>
<p>Let's plot the resulting parent orientations</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="nb">plot</span><span class="p">(</span><span class="n">parentGrains</span><span class="p">(</span><span class="s1">'Iron fcc'</span><span class="p">),</span><span class="n">parentGrains</span><span class="p">(</span><span class="s1">'Iron fcc'</span><span class="p">)</span><span class="o">.</span><span class="n">meanOrientation</span><span class="p">)</span></code></pre></figure>
<center>
<img class="inline" src="images/MaParentGrainReconstructionAdvanced_06.png" alt="" />

</center><h2 id="15">Compute Child Variants</h2><p>Knowing the parent grain orientations we may compute the <a href="|variantId|">|variantId|</a> of each child grain using the command <a href="calcVariantId.html"><code class="language-plaintext highlighter-rouge">calcVariantId</code></a>. As a bonus this command returns also the <code class="language-plaintext highlighter-rouge">packetId</code>, here defined as the closest {111} plane in austenite to the (011) plane in martensite.</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="c1">% compute variantId and packetId</span>
<span class="p">[</span><span class="n">variantId</span><span class="p">,</span><span class="n">packetId</span><span class="p">]</span> <span class="o">=</span> <span class="n">calcVariantId</span><span class="p">(</span><span class="n">parentOri</span><span class="p">(</span><span class="n">parentId</span><span class="p">),</span><span class="n">childOri</span><span class="p">,</span><span class="n">fcc2bcc</span><span class="p">);</span>

<span class="c1">% associate to each packet id a color and plot</span>
<span class="n">color</span> <span class="o">=</span> <span class="n">ind2color</span><span class="p">(</span><span class="n">packetId</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">grains</span><span class="p">,</span><span class="n">color</span><span class="p">)</span>

<span class="nb">hold</span> <span class="n">on</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">parentGrains</span><span class="o">.</span><span class="nb">boundary</span><span class="p">,</span><span class="s1">'linewidth'</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="c1">% outline a specific parent grain</span>
<span class="nb">hold</span> <span class="n">on</span>
<span class="n">id</span> <span class="o">=</span> <span class="n">parentGrains</span><span class="o">.</span><span class="n">findByLocation</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span><span class="mi">80</span><span class="p">]);</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">parentGrains</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="nb">boundary</span><span class="p">,</span><span class="s1">'linewidth'</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s1">'lineColor'</span><span class="p">,</span><span class="s1">'w'</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">off</span></code></pre></figure>
<center>
<img class="inline" src="images/MaParentGrainReconstructionAdvanced_07.png" alt="" />

</center><p>In order to check our parent grain reconstruction we chose the single parent grain outlines in the above map and plot all child variants of its reconstructed parent orientation together with the actually measured child orientations inside the parent grain.</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="c1">% the measured child orientations that belong to parent grain 279</span>
<span class="n">childOri</span> <span class="o">=</span> <span class="n">ebsd</span><span class="p">(</span><span class="n">parentEBSD</span><span class="o">.</span><span class="n">grainId</span><span class="o">==</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">orientations</span><span class="p">;</span>
<span class="n">plotPDF</span><span class="p">(</span><span class="n">childOri</span><span class="p">,</span><span class="n">Miller</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">csBCC</span><span class="p">),</span><span class="s1">'MarkerSize'</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="c1">% the orientation of parent grain 279</span>
<span class="nb">hold</span> <span class="n">on</span>
<span class="n">parentOri</span> <span class="o">=</span> <span class="n">parentGrains</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">meanOrientation</span><span class="p">;</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">parentOri</span><span class="o">.</span><span class="n">symmetrise</span> <span class="o">*</span> <span class="n">Miller</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">csFCC</span><span class="p">))</span>

<span class="c1">% the theoretical child variants</span>
<span class="n">childVariants</span> <span class="o">=</span> <span class="n">variants</span><span class="p">(</span><span class="n">fcc2bcc</span><span class="p">,</span> <span class="n">parentOri</span><span class="p">);</span>
<span class="n">plotPDF</span><span class="p">(</span><span class="n">childVariants</span><span class="p">,</span> <span class="s1">'markerFaceColor'</span><span class="p">,</span><span class="s1">'none'</span><span class="p">,</span><span class="s1">'linewidth'</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">'markerEdgeColor'</span><span class="p">,</span><span class="s1">'orange'</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">off</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-plaintext" data-lang="plaintext">I'm plotting 416 random orientations out of 7140 given orientations
  You can specify the the number points by the option "points".
  The option "all" ensures that all data are plotted</code></pre></figure>
<center>
<img class="inline" src="images/MaParentGrainReconstructionAdvanced_08.png" alt="" />

</center><p>So far our analysis was at the grain level. However, once parent grain orientations have been computed we may also use them to compute parent orientations of each pixel in our original EBSD map. To this end we first find pixels that now belong to an austenite grain.</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="c1">% consider only martensite pixels that now belong to austenite grains</span>
<span class="n">isNowFCC</span> <span class="o">=</span> <span class="n">parentGrains</span><span class="o">.</span><span class="n">phaseId</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">parentEBSD</span><span class="o">.</span><span class="n">grainId</span><span class="p">))</span> <span class="o">==</span> <span class="mi">3</span> <span class="o">&amp;</span> <span class="n">parentEBSD</span><span class="o">.</span><span class="n">phaseId</span> <span class="o">==</span> <span class="mi">2</span><span class="p">;</span>

<span class="c1">% compute parent orientation</span>
<span class="p">[</span><span class="n">parentEBSD</span><span class="p">(</span><span class="n">isNowFCC</span><span class="p">)</span><span class="o">.</span><span class="n">orientations</span><span class="p">,</span> <span class="n">fit</span><span class="p">]</span> <span class="o">=</span> <span class="n">calcParent</span><span class="p">(</span><span class="n">ebsd</span><span class="p">(</span><span class="n">isNowFCC</span><span class="p">)</span><span class="o">.</span><span class="n">orientations</span><span class="p">,</span><span class="k">...</span>
  <span class="n">parentGrains</span><span class="p">(</span><span class="n">parentEBSD</span><span class="p">(</span><span class="n">isNowFCC</span><span class="p">)</span><span class="o">.</span><span class="n">grainId</span><span class="p">)</span><span class="o">.</span><span class="n">meanOrientation</span><span class="p">,</span><span class="n">fcc2bcc</span><span class="p">);</span>

<span class="c1">% plot the result</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">parentEBSD</span><span class="p">(</span><span class="s1">'Iron fcc'</span><span class="p">),</span><span class="n">parentEBSD</span><span class="p">(</span><span class="s1">'Iron fcc'</span><span class="p">)</span><span class="o">.</span><span class="n">orientations</span><span class="p">,</span><span class="s1">'figSize'</span><span class="p">,</span><span class="s1">'large'</span><span class="p">)</span></code></pre></figure>
<center>
<img class="inline" src="images/MaParentGrainReconstructionAdvanced_09.png" alt="" />

</center><p>As a second output argument we obtain the <code class="language-plaintext highlighter-rouge">misfit</code> between the parent orientation computed for the pixel and the mean orientation of the corresponding parent grain. Let's plot this misfit as a map.</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="nb">plot</span><span class="p">(</span><span class="n">parentEBSD</span><span class="p">(</span><span class="n">isNowFCC</span><span class="p">),</span><span class="n">fit</span> <span class="o">.</span><span class="p">/</span> <span class="nb">degree</span><span class="p">,</span><span class="s1">'figSize'</span><span class="p">,</span><span class="s1">'large'</span><span class="p">)</span>
<span class="n">mtexColorMap</span> <span class="n">LaboTeX</span>
<span class="n">mtexColorbar</span></code></pre></figure>
<center>
<img class="inline" src="images/MaParentGrainReconstructionAdvanced_10.png" alt="" />

</center><h2 id="19">Denoise the parent map</h2><p>Finaly we may apply filtering to the parent map to fill non indexed or not reconstructed pixels. To this end we first run grain reconstruction on the parent map</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="p">[</span><span class="n">parentGrains</span><span class="p">,</span> <span class="n">parentEBSD</span><span class="o">.</span><span class="n">grainId</span><span class="p">]</span> <span class="o">=</span> <span class="n">calcGrains</span><span class="p">(</span><span class="n">parentEBSD</span><span class="p">(</span><span class="s1">'indexed'</span><span class="p">),</span><span class="s1">'angle'</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="nb">degree</span><span class="p">);</span>

<span class="n">parentEBSD</span><span class="p">(</span><span class="n">parentGrains</span><span class="p">(</span><span class="n">parentGrains</span><span class="o">.</span><span class="n">grainSize</span><span class="o">&lt;</span><span class="mi">10</span><span class="p">))</span> <span class="o">=</span> <span class="p">[];</span>

<span class="p">[</span><span class="n">parentGrains</span><span class="p">,</span> <span class="n">parentEBSD</span><span class="o">.</span><span class="n">grainId</span><span class="p">]</span> <span class="o">=</span> <span class="n">calcGrains</span><span class="p">(</span><span class="n">parentEBSD</span><span class="p">(</span><span class="s1">'indexed'</span><span class="p">),</span><span class="s1">'angle'</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="nb">degree</span><span class="p">);</span>
<span class="n">parentGrains</span> <span class="o">=</span> <span class="n">smooth</span><span class="p">(</span><span class="n">parentGrains</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>

<span class="nb">plot</span><span class="p">(</span><span class="n">ebsd</span><span class="p">(</span><span class="s1">'indexed'</span><span class="p">),</span><span class="n">ebsd</span><span class="p">(</span><span class="s1">'indexed'</span><span class="p">)</span><span class="o">.</span><span class="n">orientations</span><span class="p">,</span><span class="s1">'figSize'</span><span class="p">,</span><span class="s1">'large'</span><span class="p">)</span>

<span class="nb">hold</span> <span class="n">on</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">parentGrains</span><span class="o">.</span><span class="nb">boundary</span><span class="p">,</span><span class="s1">'lineWidth'</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">off</span></code></pre></figure>
<center>
<img class="inline" src="images/MaParentGrainReconstructionAdvanced_11.png" alt="" />

</center><p>and then use the command <a href="EBSD.smooth.html"><code class="language-plaintext highlighter-rouge">smooth</code></a> to fill the holes in the reconstructed parent map</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="c1">% fill the holes</span>
<span class="n">F</span> <span class="o">=</span> <span class="n">halfQuadraticFilter</span><span class="p">;</span>
<span class="n">parentEBSD</span> <span class="o">=</span> <span class="n">smooth</span><span class="p">(</span><span class="n">parentEBSD</span><span class="p">(</span><span class="s1">'indexed'</span><span class="p">),</span><span class="n">F</span><span class="p">,</span><span class="s1">'fill'</span><span class="p">,</span><span class="n">parentGrains</span><span class="p">);</span>

<span class="c1">% plot the parent map</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">parentEBSD</span><span class="p">(</span><span class="s1">'Iron fcc'</span><span class="p">),</span><span class="n">parentEBSD</span><span class="p">(</span><span class="s1">'Iron fcc'</span><span class="p">)</span><span class="o">.</span><span class="n">orientations</span><span class="p">,</span><span class="s1">'figSize'</span><span class="p">,</span><span class="s1">'large'</span><span class="p">)</span>

<span class="c1">% with grain boundaries</span>
<span class="nb">hold</span> <span class="n">on</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">parentGrains</span><span class="o">.</span><span class="nb">boundary</span><span class="p">,</span><span class="s1">'lineWidth'</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">off</span></code></pre></figure>
<center>
<img class="inline" src="images/MaParentGrainReconstructionAdvanced_12.png" alt="" />

</center><h2 id="21">Summary of relevant thresholds</h2><p>In the above script several parameters are decisive for the success of the reconstruction</p><div><ul><li>threshold for initial grain segmentation (3 degree)</li><li>theshold (2 degree), tolerance (1.5 degree) and inflation power (p = 1.6) of the Markovian clustering algorithm</li><li>maximum misfit within a parent grain (5 degree)</li><li>minimum number of merged child grains</li></ul></div><h2 id="22">Triple Point Based Analysis</h2><p>A problem of the boundary based reconstuction algorithm is that often child variants of different grains have a misorientation that is close to the theoretical child to child misorientation. One idea to overcome this problem is to analyze triple junctions. Now all three child orientations must fit to a common parent orientations. This fit is computed by the command <a href="calcParent.html"><code class="language-plaintext highlighter-rouge">calcParent</code></a>.</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="c1">% extract child orientations at triple junctions</span>
<span class="n">tP</span> <span class="o">=</span> <span class="n">grains</span><span class="o">.</span><span class="n">triplePoints</span><span class="p">;</span>
<span class="n">tPori</span> <span class="o">=</span> <span class="n">grains</span><span class="p">(</span><span class="n">tP</span><span class="o">.</span><span class="n">grainId</span><span class="p">)</span><span class="o">.</span><span class="n">meanOrientation</span><span class="p">;</span>

<span class="c1">% compute the misfit to a common parent orientation</span>
<span class="p">[</span><span class="o">~</span><span class="p">,</span> <span class="n">fit</span><span class="p">]</span> <span class="o">=</span> <span class="n">calcParent</span><span class="p">(</span><span class="n">tPori</span><span class="p">,</span><span class="n">fcc2bcc</span><span class="p">,</span><span class="s1">'id'</span><span class="p">,</span><span class="s1">'threshold'</span><span class="p">,</span><span class="mi">5</span><span class="o">*</span><span class="nb">degree</span><span class="p">);</span></code></pre></figure>
<p>Lets visualize this misfit by colorizing all triple junctions accordingly.</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="nb">plot</span><span class="p">(</span><span class="n">ebsd</span><span class="p">(</span><span class="s1">'Iron bcc'</span><span class="p">),</span><span class="n">ebsd</span><span class="p">(</span><span class="s1">'Iron bcc'</span><span class="p">)</span><span class="o">.</span><span class="n">orientations</span><span class="p">,</span><span class="s1">'figSize'</span><span class="p">,</span><span class="s1">'large'</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">on</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">grains</span><span class="o">.</span><span class="nb">boundary</span><span class="p">,</span><span class="s1">'linewidth'</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">off</span>

<span class="nb">hold</span> <span class="n">on</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">tP</span><span class="p">,</span><span class="n">fit</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="o">.</span><span class="p">/</span> <span class="nb">degree</span><span class="p">,</span><span class="s1">'MarkerEdgecolor'</span><span class="p">,</span><span class="s1">'k'</span><span class="p">,</span><span class="s1">'MarkerSize'</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="n">setColorRange</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">mtexColorMap</span> <span class="n">LaboTeX</span>
<span class="n">mtexColorbar</span>
<span class="nb">hold</span> <span class="n">off</span></code></pre></figure>
<center>
<img class="inline" src="images/MaParentGrainReconstructionAdvanced_13.png" alt="" />

</center><p>Again we observe, that triple junctions with large misfit outline the shape of the parent grains. In order to identify these parent grains we proceed analogously as for the boundary based analysis. We first set up a similarity matrix between grains connected to the same triple points and than use the Markovian clustering algorithm to detect clusters of child grains, which are than merged into parent grains.</p><h2 id="25">Create a similarity matrix and reconstruct parent grains</h2><p>The setup and the clustering of the similarity matrix is the same as above</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="n">threshold</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="nb">degree</span><span class="p">;</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="nb">degree</span><span class="p">;</span>

<span class="c1">% compute the probabilities</span>
<span class="n">prob</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nb">erf</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">fit</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">threshold</span><span class="p">)</span><span class="o">.</span><span class="p">/</span><span class="n">tol</span><span class="p">));</span>

<span class="c1">% the corresponding similarity matrix</span>
<span class="n">A</span> <span class="o">=</span> <span class="nb">sparse</span><span class="p">(</span><span class="n">tP</span><span class="o">.</span><span class="n">grainId</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">tP</span><span class="o">.</span><span class="n">grainId</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span><span class="n">prob</span><span class="p">,</span><span class="nb">length</span><span class="p">(</span><span class="n">grains</span><span class="p">),</span><span class="nb">length</span><span class="p">(</span><span class="n">grains</span><span class="p">));</span>
<span class="n">A</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="nb">sparse</span><span class="p">(</span><span class="n">tP</span><span class="o">.</span><span class="n">grainId</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span><span class="n">tP</span><span class="o">.</span><span class="n">grainId</span><span class="p">(:,</span><span class="mi">3</span><span class="p">),</span><span class="n">prob</span><span class="p">,</span><span class="nb">length</span><span class="p">(</span><span class="n">grains</span><span class="p">),</span><span class="nb">length</span><span class="p">(</span><span class="n">grains</span><span class="p">)));</span>
<span class="n">A</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="nb">sparse</span><span class="p">(</span><span class="n">tP</span><span class="o">.</span><span class="n">grainId</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="n">tP</span><span class="o">.</span><span class="n">grainId</span><span class="p">(:,</span><span class="mi">3</span><span class="p">),</span><span class="n">prob</span><span class="p">,</span><span class="nb">length</span><span class="p">(</span><span class="n">grains</span><span class="p">),</span><span class="nb">length</span><span class="p">(</span><span class="n">grains</span><span class="p">)));</span>

<span class="n">p</span> <span class="o">=</span> <span class="mf">1.4</span><span class="p">;</span> <span class="c1">% inflation power:</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">mclComponents</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">p</span><span class="p">);</span></code></pre></figure>
<p>Each connected component of the resulting adjacency matrix describes one parent grain. Hence, we can use this adjacency matrix to merge child grains into parent grains by the command <a href="graind2d.merge.html"><code class="language-plaintext highlighter-rouge">merge</code></a>.</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="c1">% merge grains according to the adjacency matrix A</span>
<span class="p">[</span><span class="n">parentGrains</span><span class="p">,</span> <span class="n">parentId</span><span class="p">]</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">grains</span><span class="p">,</span><span class="n">A</span><span class="p">);</span>

<span class="c1">% ensure grainId in parentEBSD is set up correctly with parentGrains</span>
<span class="n">parentEBSD</span> <span class="o">=</span> <span class="n">ebsd</span><span class="p">;</span>
<span class="n">parentEBSD</span><span class="p">(</span><span class="s1">'indexed'</span><span class="p">)</span><span class="o">.</span><span class="n">grainId</span> <span class="o">=</span> <span class="n">parentId</span><span class="p">(</span><span class="n">ebsd</span><span class="p">(</span><span class="s1">'indexed'</span><span class="p">)</span><span class="o">.</span><span class="n">grainId</span><span class="p">);</span></code></pre></figure>
<p>Let's visualize the result. Afterwards, we can proceed analogously as for the boundary based parent grain reconstruction described above.</p>
<figure class="highlight"><pre><code class="language-matlab" data-lang="matlab"><span class="nb">plot</span><span class="p">(</span><span class="n">ebsd</span><span class="p">(</span><span class="s1">'Iron bcc'</span><span class="p">),</span><span class="n">ebsd</span><span class="p">(</span><span class="s1">'Iron bcc'</span><span class="p">)</span><span class="o">.</span><span class="n">orientations</span><span class="p">,</span><span class="s1">'figSize'</span><span class="p">,</span><span class="s1">'large'</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">on</span><span class="p">;</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">parentGrains</span><span class="o">.</span><span class="nb">boundary</span><span class="p">,</span><span class="s1">'linewidth'</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="nb">gcf</span><span class="p">,</span><span class="s1">'Renderer'</span><span class="p">,</span><span class="s1">'painters'</span><span class="p">)</span>
<span class="nb">hold</span> <span class="n">off</span></code></pre></figure>
<center>
<img class="inline" src="images/MaParentGrainReconstructionAdvanced_14.png" alt="" />

</center></div></body></html>

    <div class="tags">
        
    </div>

    


</div>

<footer>
    <div class="row">
        <div class="col-lg-12 footer">
            <p>
                <img src="images/icons/MTEX_100x67px.png" alt="MTEX logo">
            </p>
        </div>
    </div>
</footer>

        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

<!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-83346204-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>


</html>
