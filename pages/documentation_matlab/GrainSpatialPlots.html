---
title: Plotting
last_updated: 29-Sep-2019
sidebar: documentation_sidebar
permalink: GrainSpatialPlots.html
folder: documentation
toc: false
---

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Plotting</title><meta name="generator" content="MATLAB 9.7"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-09-29"><meta name="DC.source" content="script_GrainSpatialPlots.m"></head><body><font size="2"><a href="#" data-toggle="tooltip" data-original-title="To edit this page type edit GrainSpatialPlots into the Matlab commandline">edit page</a></font><div><!--introduction--><!--/introduction--><p>We start by importing some EBSD data and reconstructing some grains</p><pre class="codeinput"><span class="comment">% import a demo data set</span>
mtexdata <span class="string">forsterite</span>
plotx2east

<span class="comment">% consider only indexed data for grain segmentation</span>
ebsd = ebsd(<span class="string">'indexed'</span>);

<span class="comment">% perform grain segmentation</span>
[grains,ebsd.grainId,ebsd.mis2mean] = calcGrains(ebsd);
</pre><h2 id="2">Phase maps</h2><p>When using the <a href="grain2d.plot.html">plot</a> command without additional argument the associated color is defined by color stored in the crystal symmetry for each phase</p><pre class="codeinput">close <span class="string">all</span>
plot(grains)

grains(<span class="string">'Fo'</span>).CS.color
</pre><pre class="codeoutput">ans =
    0.5294    0.8078    0.9804
</pre>
  {% include inline_image.html file="GrainSpatialPlots_01.png" %}
<p>Accodingly, changing the color stored in the crystal symmetry changes the color in the map</p><pre class="codeinput">grains(<span class="string">'Fo'</span>).CS.color = str2rgb(<span class="string">'salmon'</span>)
plot(grains)
</pre><pre class="codeoutput"> 
grains = grain2d  
 
 Phase  Grains  Pixels     Mineral  Symmetry  Crystal reference frame
     1    1080  152345  Forsterite       mmm                         
     2     515   26058   Enstatite       mmm                         
     3    1496    9064    Diopside     12/m1       X||a*, Y||b*, Z||c
 
 boundary segments: 43912
 triple points: 3417
 
 Properties: GOS, meanRotation
 
</pre>
  {% include inline_image.html file="GrainSpatialPlots_02.png" %}
<p>The color can also been specified directly by using the option <tt>FaceColor</tt>. Note, that this requires the color to be specified by RGB values.</p><pre class="codeinput"><span class="comment">% detect the largest grain</span>
[~,id] = max(grains.area);

<span class="comment">% plot the grain in dark black with some transperency</span>
hold <span class="string">on</span>
plot(grains(id),<span class="string">'FaceColor'</span>,<span class="string">'darkgray'</span>,<span class="string">'FaceAlpha'</span>,0.5)
hold <span class="string">off</span>
</pre>
  {% include inline_image.html file="GrainSpatialPlots_03.png" %}
<h2 id="5">Orientation Maps</h2><p>Coloring grains according to their mean orientations is very similar to EBSD maps colored by orientations. The most important thing is that the misorientation can only extracte from grains of the same phase.</p><pre class="codeinput"><span class="comment">% the implicite way</span>
plot(grains(<span class="string">'Fo'</span>),grains(<span class="string">'fo'</span>).meanOrientation)
</pre><pre class="codeoutput">  I'm going to colorize the orientation data with the 
  standard MTEX colorkey. To view the colorkey do:
 
  colorKey = ipfColorKey(ori_variable_name)
  plot(colorKey)
</pre>
  {% include inline_image.html file="GrainSpatialPlots_04.png" %}
<p>This implicte way gives no control about how the color is computed from the meanorientation. When using the explicite way by defining a orientation to color map</p><pre class="codeinput"><span class="comment">% this defines a ipf color key</span>
ipfKey = ipfColorKey(grains(<span class="string">'Fo'</span>));
</pre><p>we can set the inverse pole figure direction and many other properties</p><pre class="codeinput">ipfKey.inversePoleFigureDirection = xvector;

<span class="comment">% compute the colors from the meanorientations</span>
color = ipfKey.orientation2color(grains(<span class="string">'Fo'</span>).meanOrientation);

<span class="comment">% and use them for plotting</span>
plot(grains(<span class="string">'fo'</span>),color)
</pre>
  {% include inline_image.html file="GrainSpatialPlots_05.png" %}
<h2 id="8">Plotting arbitrary properties</h2><p>As we have seen in the previous section the <tt>plot</tt> command accepts as second argument any list of RGB values specifying a color. Instead of RGB values the second argument can also be a list of values which are then transformed by a colormap into color.</p><p>As an example we colorize the grains according to their aspect ratio.</p><pre class="codeinput">plot(grains,grains.aspectRatio)
</pre>
  {% include inline_image.html file="GrainSpatialPlots_06.png" %}
<p>we see that we have a very alongated grain which makes it difficult to distinguesh the aspect ration of the other grains. A solution for this is to specify the values of the aspect ration which should maped to the top and bottom color of the colormap</p><pre class="codeinput">CLim(gcm,[1 5])
</pre>
  {% include inline_image.html file="GrainSpatialPlots_07.png" %}
<h2 id="11">Colorizing circular properties</h2><p>Sometimes the property we want to display is a circular, e.g., the direction of the grain alongation. In this case it is important to use a circular colormap which assign the same color to high values and low values. In the case of the direction of the grain alongation the angles 0 and 180 should get the same color since they represent the same direction.</p><pre class="codeinput"><span class="comment">% consider only alongated grains</span>
alongated_grains = grains(grains.aspectRatio &gt; 5);

<span class="comment">% get the grain alongation</span>
dir = alongated_grains.principalComponents;

<span class="comment">% transfer this into degree and project it into the interval [0,180]</span>
dir = mod(dir./degree,180);

<span class="comment">% plot the direction</span>
plot(alongated_grains,dir,<span class="string">'micronbar'</span>,<span class="string">'off'</span>)

<span class="comment">% change the default colormap to a circular one</span>
mtexColorMap <span class="string">HSV</span>

<span class="comment">% display the colormap</span>
mtexColorbar
</pre>
  {% include inline_image.html file="GrainSpatialPlots_08.png" %}
<h2 id="12">Plotting the orientation within a grain</h2><p>In order to plot the orientations of EBSD data within certain grains one first has to extract the EBSD data that belong to the specific grains.</p><pre class="codeinput"><span class="comment">% let have a look at the bigest grain</span>
[~,id] = max(grains.area)

<span class="comment">% and select the corresponding EBSD data</span>
ebsd_maxGrain = ebsd(ebsd.grainId == id)

<span class="comment">% the previous command is equivalent to the more simpler</span>
ebsd_maxGrain = ebsd(grains(id));
</pre><pre class="codeoutput">id =
   931
 
ebsd_maxGrain = EBSD  
 
 Phase  Orientations     Mineral         Color  Symmetry  Crystal reference frame
     1   2683 (100%)  Forsterite  LightSkyBlue       mmm                         
 
 Properties: bands, bc, bs, error, mad, x, y, grainId, mis2mean
 Scan unit : um
 
</pre><pre class="codeinput"><span class="comment">% compute the color out of the orientations</span>
color = ipfKey.orientation2color(ebsd_maxGrain.orientations);

<span class="comment">% plot it</span>
plot(ebsd_maxGrain, color,<span class="string">'micronbar'</span>,<span class="string">'off'</span>)

<span class="comment">% plot the grain boundary on top</span>
hold <span class="string">on</span>
plot(grains(id).boundary,<span class="string">'linewidth'</span>,2)
hold <span class="string">off</span>
</pre>
  {% include inline_image.html file="GrainSpatialPlots_09.png" %}
<h2 id="14">Visualizing directions</h2><p>We may also visualize directions by arrows placed at the center of the grains.</p><pre class="codeinput"><span class="comment">% load some single phase data set</span>
mtexdata <span class="string">csl</span>

<span class="comment">% compute and plot grains</span>
[grains,ebsd.grainId] = calcGrains(ebsd);
plot(grains,grains.meanOrientation,<span class="string">'micronbar'</span>,<span class="string">'off'</span>,<span class="string">'figSize'</span>,<span class="string">'large'</span>)

<span class="comment">% next we want to visualize the direction of the 100 axis</span>
dir = grains.meanOrientation * Miller(1,0,0,grains.CS);

<span class="comment">% the lenght of the vectors should depend on the grain diameter</span>
len = 0.25*grains.diameter;

<span class="comment">% arrows are plotted using the command quiver. We need to switch of auto</span>
<span class="comment">% scaling of the arrow length</span>
hold <span class="string">on</span>
quiver(grains,len.*dir,<span class="string">'autoScale'</span>,<span class="string">'off'</span>,<span class="string">'color'</span>,<span class="string">'black'</span>)
hold <span class="string">off</span>
</pre><pre class="codeoutput">  I'm going to colorize the orientation data with the 
  standard MTEX colorkey. To view the colorkey do:
 
  colorKey = ipfColorKey(ori_variable_name)
  plot(colorKey)
</pre>
  {% include inline_image.html file="GrainSpatialPlots_10.png" %}
<h2 id="15">Labeling Grains</h2><p>In the above example the vectors are centered at the centroids of the grains. Other elements</p><pre class="codeinput"><span class="comment">% only the very big grains</span>
big_grains = grains(grains.grainSize&gt;1000);

<span class="comment">% plot them</span>
plot(big_grains,big_grains.meanOrientation,<span class="string">'micronbar'</span>,<span class="string">'off'</span>)

<span class="comment">% plot on top their ids</span>
text(big_grains,int2str(big_grains.id))
</pre><pre class="codeoutput">  I'm going to colorize the orientation data with the 
  standard MTEX colorkey. To view the colorkey do:
 
  colorKey = ipfColorKey(ori_variable_name)
  plot(colorKey)
</pre>
  {% include inline_image.html file="GrainSpatialPlots_11.png" %}
</div></body></html>