---
title: Reference Frame Alignment
last_updated: 05-Oct-2019
sidebar: documentation_sidebar
permalink: EBSDReferenceFrame.html
folder: documentation
toc: false
---

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Reference Frame Alignment</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-10-05"><meta name="DC.source" content="script_EBSDReferenceFrame.m"></head><body><font size="2"><a href="#" data-toggle="tooltip" data-original-title="To edit this page type edit EBSDReferenceFrame into the Matlab commandline">edit page</a></font><div><!--introduction--><!--/introduction--><p>In this section we discuss how you can put your data into MTEX while keeping track with the correct reference system. Many peoply are concerned when the images produced by MTEX are not aligned exactly as they are in their commercial software. It is very important indeed  to understand exactly the alignment of you data. However, the important point is not whether a map upside down on you screen or not. The important point is how your map alignes with the specimen, as we want to use the map to describe properties of the specimen.</p><p>There are basicaly two components in an EBSD data set that refers to the specimen reference frame: the spatial coordinates x,y and the Euler angles 
  {% include inline_image.html file="EBSDReferenceFrame_eq06418280246876342884.png" %}
, 
  {% include inline_image.html file="EBSDReferenceFrame_eq01908532921846404702.png" %}
, 
  {% include inline_image.html file="EBSDReferenceFrame_eq17001684417795047500.png" %}
. The spatial coordinates are important when plotting an EBSD map, e.g. by</p><pre class="codeinput">mtexdata <span class="string">forsterite</span>;

plotx2east; plotzOutOfPlane
plot(ebsd,<span class="string">'coordinates'</span>,<span class="string">'on'</span>)
</pre><pre class="codeoutput"> 
ebsd = EBSD  
 
 Phase  Orientations     Mineral         Color  Symmetry  Crystal reference frame
     0   58485 (24%)  notIndexed                                                 
     1  152345 (62%)  Forsterite  LightSkyBlue       mmm                         
     2   26058 (11%)   Enstatite  DarkSeaGreen       mmm                         
     3   9064 (3.7%)    Diopside     Goldenrod     12/m1       X||a*, Y||b*, Z||c
 
 Properties: bands, bc, bs, error, mad, x, y
 Scan unit : um
 
</pre>
  {% include inline_image.html file="EBSDReferenceFrame_01.png" %}
<p>In MTEX you can freely adjust the orientation of the map on the screen by adjusting the alignment of the x and y axis, e.g., the following lines will show the map upside down</p><pre class="codeinput">plotx2east; plotzIntoPlane
plot(ebsd,<span class="string">'coordinates'</span>,<span class="string">'on'</span>)
</pre>
  {% include inline_image.html file="EBSDReferenceFrame_02.png" %}
<p>Note that we did not changed the data but only displayed them differently on the screen.</p><p>The reference frame of the Euler angles commes into importance when plotting ODFs or pole figures.</p><pre class="codeinput">plotPDF(ebsd(<span class="string">'Fo'</span>).orientations,Miller(1,0,0,ebsd(<span class="string">'Fo'</span>).CS),<span class="string">'contourf'</span>)
</pre>
  {% include inline_image.html file="EBSDReferenceFrame_03.png" %}
<h2 id="4">TODO: TO BE CONTINUED</h2><p>As the pole figure displays data relative to the specimen reference frame MTEX automatically aligns it on the screen exatcly as the spatial map above, i.e., according to our last definition with x pointing towards east and y to the south.</p><p>as well as some pole figure data</p><pre class="codeinput">close <span class="string">all</span>
CS = ebsd(<span class="string">'forsterite'</span>).CS;
plotPDF(ebsd(<span class="string">'forsterite'</span>).orientations,Miller(1,2,3,CS),<span class="string">'contourf'</span>)
</pre>
  {% include inline_image.html file="EBSDReferenceFrame_04.png" %}
<h2 id="6">Altering the graphical output</h2><p>If you are unsatisfied with the orientation of your EBSD map in the graphical output this might be simply because the alignment of the reference frame of your data on your plot is not correct. In the above pictures the x-axis is plotted to east and the z-axis is plotted out of plane. Assume you want to change this to z-axis into plane you need to do</p><pre class="codeinput">plotzIntoPlane;
plot(ebsd)
</pre>
  {% include inline_image.html file="EBSDReferenceFrame_05.png" %}
<p>Observe, how the y-axis is inverted but the x-axis is still plotted in east direction. This change of the alignment of the reference frame does not only effect spatial EBSD plots but also all pole figure plots.</p><pre class="codeinput">plotPDF(ebsd(<span class="string">'fo'</span>).orientations,Miller(1,2,3,CS),<span class="string">'contourf'</span>)
</pre>
  {% include inline_image.html file="EBSDReferenceFrame_06.png" %}
<p>However, by changing the alignment of the reference frame in the graphical output non of the imported spatial coordinats nor the Euler angles are changed. In particular any estimated ODF is not effected by those changes of the alignment of the reference frame in the plots.</p><h2 id="9">Rotatating the data - realigning the reference frame</h2><p>Sometimes it is necessary to relate the EBSD data to a different external reference frame, or to  change the external reference frame from one to the other, e.g. if one wants to concatenate several ebsd data sets where the mounting was not done in perfect coincidence. In these cases the data has to be rotated or shifted by the commands <a href="EBSD.rotate.html">rotate</a> and <a href="EBSD.shift.html">shift</a>. The following commands rotate the reference frame of the entire data set by 5 degree about the z-axis.</p><pre class="codeinput"><span class="comment">% define a rotation</span>
rot = rotation.byAxisAngle(zvector,5*degree);

<span class="comment">% rotate the EBSD data</span>
ebsd_rot = rotate(ebsd,rot);

<span class="comment">% plot the rotated EBSD data</span>
plot(ebsd_rot)
</pre>
  {% include inline_image.html file="EBSDReferenceFrame_07.png" %}
<p>It should be stressed that this rotation on does not only effect the spatial data, i.e. the x, y values, but also the Euler angles are rotated accordingly.</p><pre class="codeinput">plotPDF(ebsd_rot(<span class="string">'fo'</span>).orientations,Miller(1,2,3,CS),<span class="string">'contourf'</span>)
</pre>
  {% include inline_image.html file="EBSDReferenceFrame_08.png" %}
<h2 id="11">See also</h2><p>EBSD/rotate EBSD/shift EBSD/affinetrans</p><h2 id="12">Correcting for different reference frames in spatial data and Euler angles</h2><p>Sometimes the imported spatial data and the imported Euler angles do not coresspond to the same reference frame. Since MTEX always assumes these reference frames to be the same it might be neccessary to correct for this misalignment. This can be done by rotating the spatial data or the Euler angles seperately using the options <tt>keepXY</tt> or <tt>keepEuler</tt>. E.g. the following command only effect the spatial coordinates but not the Euler angles</p><pre class="codeinput"><span class="comment">% rotate the EBSD data</span>
ebsd_rot = rotate(ebsd,rot,<span class="string">'keepEuler'</span>);

<span class="comment">% plot the rotated EBSD data</span>
plot(ebsd_rot)
</pre>
  {% include inline_image.html file="EBSDReferenceFrame_09.png" %}
<p>The pole figure remains unchanged:</p><pre class="codeinput">plotPDF(ebsd_rot(<span class="string">'forsterite'</span>).orientations,Miller(1,2,3,CS),<span class="string">'contourf'</span>)
</pre>
  {% include inline_image.html file="EBSDReferenceFrame_10.png" %}
<h2 id="14">Correcting HKL and CTF files</h2><p>Both *.ctf and *.ang data files are known to use different reference frames for spatial data and Euler angles. To corrrect for misalignment the interface supports the options <tt>convertSpatial2EulerReferenceFrame</tt> and <tt>convertEuler2SpatialReferenceFrame</tt>, e.g.,</p><pre class="language-matlab">EBSD.load(<span class="string">'fname.ang'</span>,<span class="string">'convertSpatial2EulerReferenceFrame'</span>)
EBSD.load(<span class="string">'fname.ang'</span>,<span class="string">'convertEuler2SpatialReferenceFrame'</span>)
</pre><p>In the first case the spatial data are changed such that the Euler angles referene frame coincides with the spatial reference frame and in the second case the Euler angles are altered to get coincidence.</p><pre class="codeinput"><span class="comment">% revert z-axis convention</span>
plotzOutOfPlane;
</pre></div></body></html>