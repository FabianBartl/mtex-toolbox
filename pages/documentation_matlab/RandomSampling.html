---
title: Random Sampling
last_updated: 01-Aug-2020
sidebar: documentation_sidebar
permalink: RandomSampling.html
folder: documentation
toc: false
---
    <html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Random Sampling</title><meta name="generator" content="MATLAB 9.9"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2020-08-01"><meta name="DC.source" content="script_RandomSampling.m"></head><body><font size="2"><a href="https://github.com/mtex-toolbox/mtex/blob/develop/doc/ODFAnalysis/RandomSampling.m">
    edit page</a></font><div><!--introduction--><!--/introduction--><p>Assume an arbitrary <a href="ODFTheorie.html">ODF</a> either from texture modelling or recovered from XRD pole figure measurements a common problem is the simulation of random individual orientations that are distributed according the given ODF. This is helpful crucial in many application, e.g., for running plastic deformation models like VPSC or verifying the accuracy <a href="DensityEstimation.html">density estimation methods</a>. Here we start with a trigonal alpha-fibre ODF which we define by</p>
{% highlight matlab %}
cs = crystalSymmetry('32');
%fibre_odf = 0.5*uniformODF(cs) + 0.5*fibreODF(Miller(0,0,0,1,cs),zvector,'halfwidth',20*degree);

fibre_odf = 0.5*uniformODF(cs) + 0.5*fibreODF(fibre.alpha(cs),'halfwidth',20*degree);
{% endhighlight %}

{% highlight matlab %}
plot(fibre_odf,'sections',6,'silent')
mtexColorbar
{% endhighlight %}
<center>
{% include inline_image.html file="RandomSampling_01.png" %}
</center><h2 id="3">Computing Random Orientations</h2><p>In order to compute \(50000\) random orientation from the ODF <code class="language-plaintext highlighter-rouge">fibre_odf</code> we use the command <a href="ODF.discreteSample.html">discreteSample</a>.</p>
{% highlight matlab %}
ori = fibre_odf.discreteSample(50000)

% plot the orientations into the Bunge sections
hold on
plot(ori,'MarkerFaceColor','none','MarkerEdgeAlpha',0.5,'all','MarkerEdgeColor','k','MarkerSize',4)
hold off
{% endhighlight %}

{% highlight plaintext %}
ori = orientation  
  size: 50000 x 1
  crystal symmetry : 321, X||a*, Y||b, Z||c
  specimen symmetry: 1
 
  <a href="matlab:Euler(getappdata(0,'data2beDisplayed'))">show Euler angles</a>
{% endhighlight %}
<center>
{% include inline_image.html file="RandomSampling_02.png" %}
</center><p>From the above plot it is very hard to judge whether the orientations are indeed distributed according to the given ODF. The reason for this is the not volume preserving projection of the Bunge sections. A better ODF representation for this purpose are <a href="SigmaSections.html">sigma sections</a></p>
{% highlight matlab %}
% plot the ODF in sigma sections
plot(fibre_odf,'sections',6,'silent','sigma','contour','linewidth',2)

% plot the orientations into the sigma sections
hold on
plot(ori,'MarkerFaceColor','none','MarkerEdgeAlpha',0.5,'all','MarkerEdgeColor','k','MarkerSize',4)
hold off
{% endhighlight %}
<center>
{% include inline_image.html file="RandomSampling_03.png" %}
</center><h2 id="5">ODF Estimation from Random Orientations</h2><p>From the last plot we clearly see that the orientations are more dense close to the alpha fibre. In order more quantitative meaure for how well do the orientations approximate the ODF we may use the orientations to estimate a new ODF and compare the fit of this estimate ODF with the initial ODF.</p><p>First, we determine the optimal kernel function</p>
{% highlight matlab %}
psi = calcKernel(ori)
{% endhighlight %}

{% highlight plaintext %}
psi = deLaValleePoussinKernel  
  bandwidth: 31
  halfwidth: 8Â°
{% endhighlight %}
<p>and then we use this kernel function for <a href="DensityEstimation.html">kernel density estimation</a></p>
{% highlight matlab %}
odf_rec = calcDensity(ori,'kernel',psi)
{% endhighlight %}

{% highlight plaintext %}
odf_rec = ODF  
  crystal symmetry : 321, X||a*, Y||b, Z||c
  specimen symmetry: 1
 
  Harmonic portion:
    degree: 31
    weight: 1
{% endhighlight %}
<p>which results in the ODF <code class="language-plaintext highlighter-rouge">odf</code></p>
{% highlight matlab %}
plot(odf_rec,'sections',6,'silent')
{% endhighlight %}
<center>
{% include inline_image.html file="RandomSampling_04.png" %}
</center><p>We may now compare the original model ODF <code class="language-plaintext highlighter-rouge">fibre_odf</code> with the reconstructed ODF <code class="language-plaintext highlighter-rouge">odf</code>.</p>
{% highlight matlab %}
calcError(odf_rec,fibre_odf)
{% endhighlight %}

{% highlight plaintext %}
ans =
    0.0783
{% endhighlight %}
</div></body></html>