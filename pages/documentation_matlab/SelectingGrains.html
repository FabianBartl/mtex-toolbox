---
title: Selecting Grains
last_updated: 28-Sep-2019
sidebar: documentation_sidebar
permalink: SelectingGrains.html
folder: documentation
toc: false
---

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Selecting Grains</title><meta name="generator" content="MATLAB 9.7"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-09-28"><meta name="DC.source" content="script_SelectingGrains.m"></head><body><font size="2"><a href="#" data-toggle="tooltip" data-original-title="To edit this page type edit SelectingGrains into the Matlab commandline">edit page</a></font><div><!--introduction--><p>TODO: This help page needs to be improved</p><!--/introduction--><p>In this section we discuss how to select grains by properties. We start our discussion by reconstructing the grain structure from a sample EBSD data set.</p><pre class="codeinput"><span class="comment">% load sample EBSD data set</span>
mtexdata <span class="string">forsterite</span>

<span class="comment">% restrict it to a subregion of interest.</span>
ebsd = ebsd(inpolygon(ebsd,[5 2 10 5]*10^3));

<span class="comment">% remove all not indexed pixels</span>
ebsd = ebsd(<span class="string">'indexed'</span>)

<span class="comment">% reconstruct grains</span>
[grains, ebsd.grainId] = calcGrains(ebsd,<span class="string">'angle'</span>,5*degree)

<span class="comment">% smooth them</span>
grains = smooth(grains,5);

<span class="comment">% plot the orientation data of the Forsterite phase</span>
plot(ebsd(<span class="string">'fo'</span>),ebsd(<span class="string">'fo'</span>).orientations)

<span class="comment">% plot the grain boundary on top of it</span>
hold <span class="string">on</span>
plot(grains.boundary,<span class="string">'lineWidth'</span>,2)
hold <span class="string">off</span>
</pre><pre class="codeoutput"> 
ebsd = EBSD  
 
 Phase  Orientations     Mineral         Color  Symmetry  Crystal reference frame
     1   14093 (87%)  Forsterite  LightSkyBlue       mmm                         
     2   1397 (8.6%)   Enstatite  DarkSeaGreen       mmm                         
     3    759 (4.7%)    Diopside     Goldenrod     12/m1       X||a*, Y||b*, Z||c
 
 Properties: bands, bc, bs, error, mad, x, y
 Scan unit : um
 
 
grains = grain2d  
 
 Phase  Grains  Pixels     Mineral  Symmetry  Crystal reference frame
     1     118   14093  Forsterite       mmm                         
     2      32    1397   Enstatite       mmm                         
     3      76     759    Diopside     12/m1       X||a*, Y||b*, Z||c
 
 boundary segments: 3915
 triple points: 284
 
 Properties: GOS, meanRotation
 
 
ebsd = EBSD  
 
 Phase  Orientations     Mineral         Color  Symmetry  Crystal reference frame
     1   14093 (87%)  Forsterite  LightSkyBlue       mmm                         
     2   1397 (8.6%)   Enstatite  DarkSeaGreen       mmm                         
     3    759 (4.7%)    Diopside     Goldenrod     12/m1       X||a*, Y||b*, Z||c
 
 Properties: bands, bc, bs, error, mad, x, y, grainId
 Scan unit : um
 
</pre>
  {% include inline_image.html file="SelectingGrains_01.png" %}
<h2 id="2">The grainId and how to select EBSD inside specific grains</h2><p>Besides, the list of grains the command <a href="EBSD.calcGrains.html">calcGrains</a> returns also two other output arguments.</p><pre class="codeinput">largeGrains = grains(grains.grainSize &gt; 50);

text(largeGrains,largeGrains.id)
</pre>
  {% include inline_image.html file="SelectingGrains_02.png" %}
<p>The second output argument grainId is a list with the same size as the EBSD measurements that stores for each measurement the corresponding grainId. The above syntax stores this list directly inside the ebsd variable. This enables MTEX to select EBSD data by grains. The following command returns all the EBSD data that belong to grain number 33.</p><pre class="codeinput">ebsd(grains(33))
</pre><pre class="codeoutput"> 
ans = EBSD  
 
 Phase  Orientations   Mineral      Color  Symmetry  Crystal reference frame
     3      1 (100%)  Diopside  Goldenrod     12/m1       X||a*, Y||b*, Z||c
 
    Id   Phase   phi1   Phi   phi2   bands   bc    bs   error   mad       x      y   grainId
 37553       3     80    16    152       7   65   113       0   0.7   11000   2550        33
 Scan unit : um
 
</pre><p>and is equivalent to the command</p><pre class="codeinput">ebsd(ebsd.grainId == 33)
</pre><pre class="codeoutput"> 
ans = EBSD  
 
 Phase  Orientations   Mineral      Color  Symmetry  Crystal reference frame
     3      1 (100%)  Diopside  Goldenrod     12/m1       X||a*, Y||b*, Z||c
 
    Id   Phase   phi1   Phi   phi2   bands   bc    bs   error   mad       x      y   grainId
 37553       3     80    16    152       7   65   113       0   0.7   11000   2550        33
 Scan unit : um
 
</pre><h2 id="6">Changing lists of grains</h2><p>As with any list in MTEX, one can single out specific grains by conditions using the syntax</p><pre class="codeinput"><span class="comment">% this gives all grains with more the 1000 pixels</span>
largeGrains = grains(grains.grainSize &gt; 1000)

hold <span class="string">on</span>
<span class="comment">% mark only large Forsterite grains</span>
plot(largeGrains(<span class="string">'Fo'</span>).boundary,<span class="string">'linewidth'</span>,2,<span class="string">'linecolor'</span>,<span class="string">'k'</span>)
hold <span class="string">off</span>
</pre><pre class="codeoutput"> 
largeGrains = grain2d  
 
 Phase  Grains  Pixels     Mineral  Symmetry  Crystal reference frame
     1       4    5248  Forsterite       mmm                         
 
 boundary segments: 875
 triple points: 79
 
  Id   Phase   Pixels          GOS   phi1   Phi   phi2
  99       1     1448    0.0132296    166   127    259
 119       1     1047   0.00740757     89    99    224
 122       1     1208   0.00806772    153    68    237
 208       1     1545    0.0124718    167    81    251
 
</pre>
  {% include inline_image.html file="SelectingGrains_03.png" %}
</div></body></html>