---
title: work
last_updated: 05-Mar-2019
sidebar: documentation_sidebar
permalink: work.html
folder: documentation_matlab
toc: false
---

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>work</title><meta name="generator" content="MATLAB 9.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-03-05"><meta name="DC.source" content="script_work.m"></head><body><font size="2"><a href="#" data-toggle="tooltip" data-original-title="To edit this page type edit work into the Matlab commandline">edit page</a></font><div><h1>work</h1><p>import spectra</p><pre class="codeinput">spec = loadallspectra(<span class="string">'~/people/hallas/3914_E1'</span>);
<span class="comment">%spec = loadallspectra('./s09');</span>

<span class="comment">% compute background</span>
bg = calc_background(spec);

<span class="comment">% plot</span>
plot_spectra(spec,bg)
</pre><pre class="codeinput"><span class="comment">%Range fits measure period in '2005'</span>
peakpos = [2520 1995 1480 1376 1354 1280 1206 1110];
peakrange = [[2509      2550];<span class="keyword">...</span>
	[1981      2009];<span class="keyword">...</span>
	[1470      1500];<span class="keyword">...</span>
	[1366      1390];<span class="keyword">...</span>
	[1344      1366];<span class="keyword">...</span>
	[1280      1295];<span class="keyword">...</span>
	[1196      1211];<span class="keyword">...</span>
	[1103      1117];<span class="keyword">...</span>
  [1015      1030]];

<span class="comment">% specify scrystal and specimen symmetry</span>
CS = crystalSymmetry(<span class="string">'-3m'</span>,[1.4,1.4,1.5]);

sf = txt2mat(<span class="string">'quartz.txt'</span>);

sfpos  = {1,[2 3],4,[5 6],7,8,[9,10],11,[13,14]};

<span class="keyword">for</span> k = 1:length(sfpos)
  i = sfpos{k};
  h{k} = Miller(sf(i,2),sf(i,3),sf(i,4),sf(i,5),CS);
  c{k} = sf(i,end).';
<span class="keyword">end</span>

<span class="comment">%r = DubnaGrid(19);</span>

<span class="comment">%h  = {Miller(1,0,-1,0,CS),...</span>
<span class="comment">%  Miller({0,1,-1,1},{1,0,-1,1},CS),...</span>
<span class="comment">%  Miller(1,1,-2,0,CS),...</span>
<span class="comment">%  Miller({0,1,-1,2},{1,0,-1,2},CS),...</span>
<span class="comment">%  Miller(1,1,-2,1,CS),...</span>
<span class="comment">%  Miller(2,0,-2,0,CS),...</span>
<span class="comment">%  Miller({0,2,-2,1},{2,0,-2,1},CS),...</span>
<span class="comment">%  Miller(1,1,-2,2,CS),...</span>
<span class="comment">%  Miller({0,2,-2,2},{2,0,-2,2},CS)};</span>

<span class="comment">% extract peaks and calculate spectra sums</span>
[sumdetectr,sumphi,sumspectr,peaks,peaksbg] = proceed_spectra(spec,bg,300:1200,peakrange);
</pre><pre class="codeinput">pf = PoleFigure(h{1},r,fliplr(squeeze(peaks(1,:,:))),CS);

<span class="keyword">for</span> k = 2:length(h)

  pf({k}) = PoleFigure(h{k}.',r,fliplr(squeeze(peaks(k,:,:))),CS);

<span class="keyword">end</span>

pf.c = c;

pf({6}) = [];

<span class="comment">%plot(rotate(pf,rotation('axis',xvector,'angle',90*degree)))</span>
plot(pf)
</pre><pre class="codeinput">odf = calcODF(pf({1:5 7:8}))
</pre><pre class="codeinput">plotPDF(odf,pf.h)
</pre><pre class="codeinput">plotPDF(odf,CS.cAxis)
</pre></div></body></html>