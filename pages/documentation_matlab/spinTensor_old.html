---
title: script_spinTensor_old
last_updated: 18-Oct-2019
sidebar: documentation_sidebar
permalink: spinTensor_old.html
folder: documentation
toc: false
---

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>script_spinTensor_old</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-10-18"><meta name="DC.source" content="script_spinTensor_old.m"></head><body><font size="2"><a href="/documentation/Contribute2Doc.html" data-toggle="tooltip" data-original-title="To edit this page type edit spinTensor_old into the Matlab commandline">edit page</a></font><div>
{% highlight matlab %}
v = vector3d.rand(100);
v.x = 0;
v = rotation.rand * v + vector3d.rand;

vsave = v;
{% endhighlight %}

{% highlight matlab %}
s = v(1);

% shift to origin
v = v - s;

% compute normal vector
[n,~] = eig3(v*v);


r = rotation.map(n(1),zvector);

v = r * v;

plot3(v.x,v.y,v.z,'.')
{% endhighlight %}
<center>
{% include inline_image.html file="spinTensor_old_01.png" %}
</center>
{% highlight matlab %}
P = [v.x(:),v.y(:)];
T = delaunayn(P);
n = size(T,1);
W = zeros(n,1);
C=0;
for m = 1:n
    sp = P(T(m,:),:);
    [null,W(m)]=convhulln(sp);
    C = C + W(m) * mean(sp);
end

C = vector3d(C(1),C(2),0)./sum(W);
{% endhighlight %}

{% highlight matlab %}
hold on
plot3(C.x,C.y,C.z,'MarkerSize',10)
hold off




function test
  % some testing code

  cs = crystalSymmetry('321');
  ori1 = orientation.rand(cs);
  ori2 = orientation.rand(cs);

  v = log(ori2,ori1);

  % this should be the same
  [norm(v),angle(ori1,ori2)] ./ degree

  % and this too
  [ori1 * orientation.byAxisAngle(v,norm(v)) ,project2FundamentalRegion(ori2,ori1)]

  % in specimen coordinates
  r = log(ori2,ori1,'left');

  % now we have to multiply from the left
  [rotation.byAxisAngle(r,norm(v)) * ori1 ,project2FundamentalRegion(ori2,ori1)]

  % the following output should be constant
  % gO = log(ori1,ori2.symmetrise) % but not true for this
  % gO = log(ori1.symmetrise,ori2) % true for this
  %
  % gO = ori2.symmetrise .* log(ori1,ori2.symmetrise) % true for this
  % gO = ori2 .* log(ori1.symmetrise,ori2) % true for this

end
{% endhighlight %}
<center>
{% include inline_image.html file="spinTensor_old_02.png" %}
</center></div></body></html>