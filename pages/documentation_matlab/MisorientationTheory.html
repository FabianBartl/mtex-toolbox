---
title: Theory of Misorientations
last_updated: 08-Oct-2019
sidebar: documentation_sidebar
permalink: MisorientationTheory.html
folder: documentation
toc: false
---

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Theory of Misorientations</title><meta name="generator" content="MATLAB 9.7"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-10-08"><meta name="DC.source" content="script_MisorientationTheory.m"></head><body><font size="2"><a href="#" data-toggle="tooltip" data-original-title="To edit this page type edit MisorientationTheory into the Matlab commandline">edit page</a></font><div><!--introduction--><p>Misorientation describes the relative orientation of two grains with respect to each other. Important concepts are twinnings and CSL (coincidence site lattice),</p><!--/introduction--><h2 id="2">Contents</h2><h2 id="3">The misorientation angle</h2><p>First we import some EBSD data set, compute grains and plot them according to their mean orientation. Next we highlight grain 70 and grain 80</p>
  {% highlight matlab %}
  mtexdata <span class="string">twins</span>
<span class="comment">% use only proper symmetry operations</span>
ebsd(<span class="string">'M'</span>).CS = ebsd(<span class="string">'M'</span>).CS.properGroup;
grains = calcGrains(ebsd(<span class="string">'indexed'</span>),<span class="string">'threshold'</span>,5*degree)
CS = grains.CS; <span class="comment">% extract crystal symmetry</span>

plot(grains,grains.meanOrientation,<span class="string">'micronbar'</span>,<span class="string">'off'</span>)
hold <span class="string">on</span>
plot(grains([74,85]).boundary,<span class="string">'edgecolor'</span>,<span class="string">'w'</span>,<span class="string">'linewidth'</span>,2)

text(grains([74,85]),{<span class="string">'1'</span>,<span class="string">'2'</span>})
  {% endhighlight %}

        {% highlight matlab %}
         
ebsd = EBSD  
 
 Phase  Orientations     Mineral         Color  Symmetry  Crystal reference frame
     0     46 (0.2%)  notIndexed                                                 
     1  22833 (100%)   Magnesium  LightSkyBlue     6/mmm       X||a*, Y||b, Z||c*
 
 Properties: bands, bc, bs, error, mad, x, y
 Scan unit : um
 
 
grains = grain2d  
 
 Phase  Grains  Pixels    Mineral  Symmetry  Crystal reference frame
     1     126   22833  Magnesium       622       X||a*, Y||b, Z||c*
 
 boundary segments: 3892
 triple points: 122
 
 Properties: GOS, meanRotation
 
  I'm going to colorize the orientation data with the 
  standard MTEX colorkey. To view the colorkey do:
 
  colorKey = ipfColorKey(ori_variable_name)
  plot(colorKey)

        {% endhighlight %}
    
  {% include inline_image.html file="MisorientationTheory_01.png" %}
<p>After extracting the mean orientation of grain 70 and 80</p>
  {% highlight matlab %}
  ori1 = grains(74).meanOrientation
ori2 = grains(85).meanOrientation
  {% endhighlight %}

        {% highlight matlab %}
         
ori1 = orientation  
  size: 1 x 1
  crystal symmetry : Magnesium (622, X||a*, Y||b, Z||c*)
  specimen symmetry: 1
 
  Bunge Euler angles in degree
     phi1     Phi    phi2    Inv.
  19.4774 78.0484 220.043       0
 
 
ori2 = orientation  
  size: 1 x 1
  crystal symmetry : Magnesium (622, X||a*, Y||b, Z||c*)
  specimen symmetry: 1
 
  Bunge Euler angles in degree
     phi1     Phi    phi2    Inv.
  71.4509 167.781 200.741       0
 

        {% endhighlight %}
    <p>we may compute the misorientation angle between both orientations by</p>
  {% highlight matlab %}
  angle(ori1, ori2) ./ degree
  {% endhighlight %}

        {% highlight matlab %}
        ans =
   85.7093

        {% endhighlight %}
    <p>Note that the misorientation angle is computed by default modulo crystal symmetry, i.e., the angle is always the smallest angles between all possible pairs of symmetrically equivalent orientations. In our example this means that symmetrisation of one orientation has no impact on the angle</p>
  {% highlight matlab %}
  angle(ori1, ori2.symmetrise) ./ degree
  {% endhighlight %}

        {% highlight matlab %}
        ans =
   85.7093
   85.7093
   85.7093
   85.7093
   85.7093
   85.7093
   85.7093
   85.7093
   85.7093
   85.7093
   85.7093
   85.7093

        {% endhighlight %}
    <p>The misorientation angle neglecting crystal symmetry can be computed by</p>
  {% highlight matlab %}
  angle(ori1, ori2.symmetrise,<span class="string">'noSymmetry'</span>)./ degree
  {% endhighlight %}

        {% highlight matlab %}
        ans =
  107.9464
  100.9175
   94.2925
  136.6180
  107.7066
  179.5952
  140.0598
  137.3717
  179.8061
  101.4414
  140.4168
   85.7093

        {% endhighlight %}
    <p>We see that the smallest angle indeed coincides with the angle computed before.</p><h2 id="9">Misorientations</h2><p>Remember that both orientations ori1 and ori2 map crystal coordinates onto specimen coordinates. Hence, the product of an inverse orientation with another orientation transfers crystal coordinates from one crystal reference frame into crystal coordinates with respect to another crystal reference frame. This transformation is called misorientation</p>
  {% highlight matlab %}
  mori = inv(ori1) * ori2
  {% endhighlight %}

        {% highlight matlab %}
         
mori = misorientation  
  size: 1 x 1
  crystal symmetry : Magnesium (622, X||a*, Y||b, Z||c*)
  crystal symmetry : Magnesium (622, X||a*, Y||b, Z||c*)
 
  Bunge Euler angles in degree
     phi1     Phi    phi2    Inv.
  149.581 94.2922 150.134       0
 

        {% endhighlight %}
    <p>In the present case the misorientation describes the coordinate transform from the reference frame of grain 80 into the reference frame of crystal 70. Take as an example the plane {11-20} with respect to the grain 80. Then the plane in grain 70 which alignes parallel to this plane can be computed by</p>
  {% highlight matlab %}
  round(mori * Miller(1,1,-2,0,CS))
  {% endhighlight %}

        {% highlight matlab %}
         
ans = Miller  
 size: 1 x 1
 mineral: Magnesium (622, X||a*, Y||b, Z||c*)
  h  2
  k -1
  i -1
  l  0

        {% endhighlight %}
    <p>Conversely, the inverse of mori is the coordinate transform from crystal 70 to grain 80.</p>
  {% highlight matlab %}
  round(inv(mori) * Miller(2,-1,-1,0,CS))
  {% endhighlight %}

        {% highlight matlab %}
         
ans = Miller  
 size: 1 x 1
 mineral: Magnesium (622, X||a*, Y||b, Z||c*)
  h  1
  k  1
  i -2
  l  0

        {% endhighlight %}
    <h2 id="12">Coincident lattice planes</h2><p>The coincidence between major lattice planes may suggest that the misorientation is a twinning misorientation. Lets analyse whether there are some more alignments between major lattice planes.</p>
  {% highlight matlab %}
  <span class="comment">%m = Miller({1,-1,0,0},{1,1,-2,0},{1,-1,0,1},{0,0,0,1},CS);</span>
m = Miller({1,-1,0,0},{1,1,-2,0},{-1,0,1,1},{0,0,0,1},CS);

<span class="comment">% cycle through all major lattice planes</span>
close <span class="string">all</span>
<span class="keyword">for</span> im = 1:length(m)
  <span class="comment">% plot the lattice planes of grains 80 with respect to the</span>
  <span class="comment">% reference frame of grain 70</span>
  plot(mori * m(im).symmetrise,<span class="string">'MarkerSize'</span>,10,<span class="keyword">...</span>
    <span class="string">'DisplayName'</span>,char(m(im)),<span class="string">'figSize'</span>,<span class="string">'large'</span>,<span class="string">'noLabel'</span>,<span class="string">'upper'</span>)
  hold <span class="string">all</span>
<span class="keyword">end</span>
hold <span class="string">off</span>

<span class="comment">% mark the corresponding lattice planes in the twin</span>
mm = round(unique(mori*m.symmetrise,<span class="string">'noSymmetry'</span>),<span class="string">'maxHKL'</span>,6);
annotate(mm,<span class="string">'labeled'</span>,<span class="string">'MarkerSize'</span>,5,<span class="string">'figSize'</span>,<span class="string">'large'</span>,<span class="string">'textAboveMarker'</span>)

<span class="comment">% show legend</span>
legend({},<span class="string">'location'</span>,<span class="string">'SouthEast'</span>,<span class="string">'FontSize'</span>,13);
  {% endhighlight %}

  {% include inline_image.html file="MisorientationTheory_02.png" %}
<p>we observe an almost perfect match for the lattice planes {11-20} to {-2110} and {1-101} to {-1101} and good coincidences for the lattice plane {1-100} to {0001} and {0001} to {0-661}. Lets compute the angles explicitly</p>
  {% highlight matlab %}
  angle(mori * Miller(1,1,-2,0,CS),Miller(2,-1,-1,0,CS)) / degree
angle(mori * Miller(1,0,-1,-1,CS),Miller(1,-1,0,1,CS)) / degree
angle(mori * Miller(0,0,0,1,CS) ,Miller(1,0,-1,0,CS),<span class="string">'noSymmetry'</span>) / degree
angle(mori * Miller(1,1,-2,2,CS),Miller(1,0,-1,0,CS)) / degree
angle(mori * Miller(1,0,-1,0,CS),Miller(1,1,-2,2,CS)) / degree
  {% endhighlight %}

        {% highlight matlab %}
        ans =
    0.4489
ans =
    0.2193
ans =
   59.6757
ans =
    2.6092
ans =
    2.5387

        {% endhighlight %}
    <h2 id="14">Twinning misorientations</h2><p>Lets define a misorientation that makes a perfect fit between the {11-20} lattice planes and between the {10-11} lattice planes</p>
  {% highlight matlab %}
  mori = orientation.map(Miller(1,1,-2,0,CS),Miller(2,-1,-1,0,CS),<span class="keyword">...</span>
  Miller(-1,0,1,1,CS),Miller(-1,1,0,1,CS))


<span class="comment">% the rotational axis</span>
round(mori.axis)

<span class="comment">% the rotational angle</span>
mori.angle / degree
  {% endhighlight %}

        {% highlight matlab %}
         
mori = misorientation  
  size: 1 x 1
  crystal symmetry : Magnesium (622, X||a*, Y||b, Z||c*)
  crystal symmetry : Magnesium (622, X||a*, Y||b, Z||c*)
 
  Bunge Euler angles in degree
  phi1  Phi phi2 Inv.
   300    0    0    0
 
 
ans = Miller  
 size: 1 x 1
 mineral: Magnesium (622, X||a*, Y||b, Z||c*)
  h  1
  k  0
  i -1
  l  0
ans =
     0

        {% endhighlight %}
    <p>and plot the same figure as before with the exact twinning misorientation.</p>
  {% highlight matlab %}
  <span class="comment">% cycle through all major lattice planes</span>
close <span class="string">all</span>
<span class="keyword">for</span> im = 1:length(m)
  <span class="comment">% plot the lattice planes of grains 80 with respect to the</span>
  <span class="comment">% reference frame of grain 70</span>
  plot(mori * m(im).symmetrise,<span class="string">'MarkerSize'</span>,10,<span class="keyword">...</span>
    <span class="string">'DisplayName'</span>,char(m(im)),<span class="string">'figSize'</span>,<span class="string">'large'</span>,<span class="string">'noLabel'</span>,<span class="string">'upper'</span>)
  hold <span class="string">all</span>
<span class="keyword">end</span>
hold <span class="string">off</span>

<span class="comment">% mark the corresponding lattice planes in the twin</span>
mm = round(unique(mori*m.symmetrise,<span class="string">'noSymmetry'</span>),<span class="string">'maxHKL'</span>,6);
annotate(mm,<span class="string">'labeled'</span>,<span class="string">'MarkerSize'</span>,5,<span class="string">'figSize'</span>,<span class="string">'large'</span>)

<span class="comment">% show legend</span>
legend({},<span class="string">'location'</span>,<span class="string">'NorthWest'</span>,<span class="string">'FontSize'</span>,13);
  {% endhighlight %}

  {% include inline_image.html file="MisorientationTheory_03.png" %}
<h2 id="16">Highlight twinning boundaries</h2><p>It turns out that in the previous EBSD map many grain boundaries have a misorientation close to the twinning misorientation we just defined. Lets Lets highlight those twinning boundaries</p>
  {% highlight matlab %}
  <span class="comment">% consider only Magnesium to Magnesium grain boundaries</span>
gB = grains.boundary(<span class="string">'Mag'</span>,<span class="string">'Mag'</span>);

<span class="comment">% check for small deviation from the twinning misorientation</span>
isTwinning = angle(gB.misorientation,mori) &lt; 5*degree;

<span class="comment">% plot the grains and highlight the twinning boundaries</span>
plot(grains,grains.meanOrientation,<span class="string">'micronbar'</span>,<span class="string">'off'</span>)
hold <span class="string">on</span>
plot(gB(isTwinning),<span class="string">'edgecolor'</span>,<span class="string">'w'</span>,<span class="string">'linewidth'</span>,2)
hold <span class="string">off</span>
  {% endhighlight %}

        {% highlight matlab %}
          I'm going to colorize the orientation data with the 
  standard MTEX colorkey. To view the colorkey do:
 
  colorKey = ipfColorKey(ori_variable_name)
  plot(colorKey)

        {% endhighlight %}
    
  {% include inline_image.html file="MisorientationTheory_04.png" %}
<p>From this picture we see that large fraction of grain boudaries are twinning boundaries. To make this observation more evident we may plot the boundary misorientation angle distribution function. This is simply the angle distribution of all boundary misorientations and can be displayed with</p>
  {% highlight matlab %}
  close <span class="string">all</span>
plotAngleDistribution(gB.misorientation)
  {% endhighlight %}

  {% include inline_image.html file="MisorientationTheory_05.png" %}
<p>From this we observe that we have about 50 percent twinning boundaries. Analogously we may also plot the axis distribution</p>
  {% highlight matlab %}
  plotAxisDistribution(gB.misorientation,<span class="string">'contour'</span>)
  {% endhighlight %}

  {% include inline_image.html file="MisorientationTheory_06.png" %}
<p>which emphasises a strong portion of rotations about the (-12-10) axis.</p><h2 id="20">Phase transitions</h2><p>Misorientations may not only be defined between crystal frames of the same phase. Lets consider the phases Magnetite and Hematite.</p>
  {% highlight matlab %}
  CS_Mag = loadCIF(<span class="string">'Magnetite'</span>)
CS_Hem = loadCIF(<span class="string">'Hematite'</span>)
  {% endhighlight %}

        {% highlight matlab %}
         
CS_Mag = crystalSymmetry  
 
  mineral : Magnetite    
  symmetry: m-3m         
  a, b, c : 8.4, 8.4, 8.4
 
 
CS_Hem = crystalSymmetry  
 
  mineral        : Hematite          
  symmetry       : -3m1              
  a, b, c        : 5, 5, 14          
  reference frame: X||a*, Y||b, Z||c*
 

        {% endhighlight %}
    <p>The phase transition from Magnetite to Hematite is described in literature by {111}_m parallel {0001}_h and {-101}_m parallel {10-10}_h The corresponding misorientation is defined in MTEX by</p>
  {% highlight matlab %}
  Mag2Hem = orientation.map(<span class="keyword">...</span>
  Miller(1,1,1,CS_Mag),Miller(0,0,0,1,CS_Hem),<span class="keyword">...</span>
  Miller(-1,0,1,CS_Mag),Miller(1,0,-1,0,CS_Hem))
  {% endhighlight %}

        {% highlight matlab %}
         
Mag2Hem = misorientation  
  size: 1 x 1
  crystal symmetry : Magnetite (m-3m)
  crystal symmetry : Hematite (-3m1, X||a*, Y||b, Z||c*)
 
  Bunge Euler angles in degree
  phi1     Phi    phi2    Inv.
   120 54.7356      45       0
 

        {% endhighlight %}
    <p>Assume a Magnetite grain with orientation</p>
  {% highlight matlab %}
  ori_Mag = orientation.byEuler(0,0,0,CS_Mag)
  {% endhighlight %}

        {% highlight matlab %}
         
ori_Mag = orientation  
  size: 1 x 1
  crystal symmetry : Magnetite (m-3m)
  specimen symmetry: 1
 
  Bunge Euler angles in degree
  phi1  Phi phi2 Inv.
     0    0    0    0
 

        {% endhighlight %}
    <p>Then we can compute all variants of the phase transition by</p>
  {% highlight matlab %}
  symmetrise(ori_Mag) * inv(Mag2Hem)
  {% endhighlight %}

        {% highlight matlab %}
         
ans = orientation  
  size: 48 x 1
  crystal symmetry : Hematite (-3m1, X||a*, Y||b, Z||c*)
  specimen symmetry: 1
 

        {% endhighlight %}
    <p>and the corresponding pole figures by</p>
  {% highlight matlab %}
  plotPDF(symmetrise(ori_Mag) * inv(Mag2Hem),<span class="keyword">...</span>
  Miller({1,0,-1,0},{1,1,-2,0},{0,0,0,1},CS_Hem))
  {% endhighlight %}

  {% include inline_image.html file="MisorientationTheory_07.png" %}
</div></body></html>