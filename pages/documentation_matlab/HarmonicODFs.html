---
title: Harmonic Series Expansion of an ODF
last_updated: 08-Oct-2019
sidebar: documentation_sidebar
permalink: HarmonicODFs.html
folder: documentation
toc: false
---

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Harmonic Series Expansion of an ODF</title><meta name="generator" content="MATLAB 9.7"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-10-08"><meta name="DC.source" content="script_HarmonicODFs.m"></head><body><font size="2"><a href="#" data-toggle="tooltip" data-original-title="To edit this page type edit HarmonicODFs into the Matlab commandline">edit page</a></font><div><!--introduction--><!--/introduction-->
  {% highlight matlab %}
  mtexdata <span class="string">dubna</span>

odf3 = calcODF(pf,<span class="string">'resolution'</span>,5*degree,<span class="string">'zero_Range'</span>)
  {% endhighlight %}

        {% highlight matlab %}
         
pf = PoleFigure  
  crystal symmetry : Quartz (321, X||a*, Y||b, Z||c*)
  specimen symmetry: 1
 
  h = (02-21), r = 72 x 19 points
  h = (10-10), r = 72 x 19 points
  h = (01-11)(10-11), r = 72 x 19 points
  h = (10-12), r = 72 x 19 points
  h = (11-20), r = 72 x 19 points
  h = (11-21), r = 72 x 19 points
  h = (11-22), r = 72 x 19 points
 
odf3 = ODF  
  crystal symmetry : Quartz (321, X||a*, Y||b, Z||c*)
  specimen symmetry: 1
 
  Radially symmetric portion:
    kernel: de la Vallee Poussin, halfwidth 10&deg;
    center: 19833 orientations, resolution: 5&deg;
    weight: 1
 

        {% endhighlight %}
    <h2 id="2">Fourier Coefficients</h2><p>The Fourier coefficients allow for a complete characterization of the ODF. The are of particular importance for the calculation of mean macroscopic properties e.g. the second order Fourier coefficients characterize thermal expansion, optical refraction index, and electrical conductivity whereas the fourth order Fourier coefficients characterize the elastic properties of the specimen. Moreover, the decay of the Fourier coefficients is directly related to the smoothness of the ODF. The decay of the Fourier coefficients might also hint for the presents of a ghost effect. See <a href="ghost_demo.html">ghost effect</a>.</p><p>transform into an odf given by Fourier coefficients</p>
  {% highlight matlab %}
  fodf = FourierODF(odf3,32)
  {% endhighlight %}

        {% highlight matlab %}
         
fodf = ODF  
  crystal symmetry : Quartz (321, X||a*, Y||b, Z||c*)
  specimen symmetry: 1
 
  Harmonic portion:
    degree: 25
    weight: 1
 

        {% endhighlight %}
    <p>The Fourier coefficients of order 2:</p>
  {% highlight matlab %}
  reshape(fodf.components{1}.f_hat(11:35),5,5)
  {% endhighlight %}

        {% highlight matlab %}
        ans =
  Columns 1 through 4
   0.0000 + 0.0000i  -0.0000 - 0.0000i   0.0000 + 0.0000i  -0.0000 + 0.0000i
  -0.0000 + 0.0000i  -0.0000 - 0.0000i   0.0000 - 0.0000i  -0.0000 + 0.0000i
   0.1419 - 0.4669i   1.5281 - 0.9319i   2.1387 + 0.0000i   1.5281 + 0.9319i
  -0.0000 - 0.0000i  -0.0000 - 0.0000i   0.0000 + 0.0000i  -0.0000 + 0.0000i
   0.0000 - 0.0000i  -0.0000 - 0.0000i   0.0000 - 0.0000i  -0.0000 + 0.0000i
  Column 5
   0.0000 + 0.0000i
  -0.0000 + 0.0000i
   0.1419 + 0.4669i
  -0.0000 - 0.0000i
   0.0000 - 0.0000i

        {% endhighlight %}
    <p>The decay of the Fourier coefficients:</p>
  {% highlight matlab %}
  close <span class="string">all</span>;
plotFourier(fodf)
  {% endhighlight %}

  {% include inline_image.html file="HarmonicODFs_01.png" %}
<h2 id="6">ODFs given by Fourier coefficients</h2><p>In order to define a ODF by it <b>Fourier coefficients</b> the Fourier coefficients <b>C</b> has to be given as a literally ordered, complex valued vector of the form</p><p>
  {% include inline_image.html file="HarmonicODFs_eq03059004171824837318.png" %}
</p><p>where 
  {% include inline_image.html file="HarmonicODFs_eq07539466353696451391.png" %}
 denotes the order of the Fourier coefficients.</p>
  {% highlight matlab %}
  cs   = crystalSymmetry(<span class="string">'1'</span>);    <span class="comment">% crystal symmetry</span>
C = [1;reshape(eye(3),[],1);reshape(eye(5),[],1)]; <span class="comment">% Fourier coefficients</span>
odf = FourierODF(C,cs)

plot(odf,<span class="string">'sections'</span>,6,<span class="string">'silent'</span>,<span class="string">'sigma'</span>)
  {% endhighlight %}

        {% highlight matlab %}
         
odf = ODF  
  crystal symmetry : 1, X||a, Y||b*, Z||c*
  specimen symmetry: 1
  antipodal:         true
 
  Harmonic portion:
    degree: 2
    weight: 1
 

        {% endhighlight %}
    
  {% include inline_image.html file="HarmonicODFs_02.png" %}

  {% highlight matlab %}
  plotPDF(odf,[Miller(1,0,0,cs),Miller(1,1,0,cs)],<span class="string">'antipodal'</span>)
  {% endhighlight %}

  {% include inline_image.html file="HarmonicODFs_03.png" %}
</div></body></html>