---
title: Shape Parameters
last_updated: 20-Mar-2019
sidebar: documentation_sidebar
permalink: ShapeParameters.html
folder: documentation
toc: false
---

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Shape Parameters</title><meta name="generator" content="MATLAB 9.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-03-20"><meta name="DC.source" content="script_ShapeParameters.m"></head><body><font size="2"><a href="#" data-toggle="tooltip" data-original-title="To edit this page type edit ShapeParameters into the Matlab commandline">edit page</a></font><div><!--introduction--><!--/introduction--><h2 id="1">First Steps and Function Overview</h2><p>Get in touch with grains.</p><h2 id="2">Grain reconstruction from EBSD data</h2><p>So far grains can be exclusively computed from EBSD data using the command <a href="EBSD.calcGrains.html">calcGrains</a>. In order to demonstrate grain reconstruction we import some EBSD data</p><pre class="codeinput">mtexdata <span class="string">forsterite</span>
plotx2east

<span class="comment">% plot the Forsterite phase colorized according to orientation</span>
plot(ebsd(<span class="string">'fo'</span>),ebsd(<span class="string">'fo'</span>).orientations)
</pre>
  {% include inline_image.html file="script_ShapeParameters_01.png" %}
<p>When reconstructing grain there are two basic ways how to deal with not indexed measurements. The simplest way is to keep the not indexed pixels separately, i.e., do not assign them to any indexed grain.</p><pre class="codeinput">[grains, ebsd.grainId] = calcGrains(ebsd,<span class="string">'angle'</span>,5*degree)
</pre><pre class="codeoutput"> 
grains = grain2d  
 
 Phase  Grains  Pixels     Mineral  Symmetry  Crystal reference frame
     0   16334   58485  notIndexed                                   
     1    4331  152345  Forsterite       mmm                         
     2    1866   26058   Enstatite       mmm                         
     3    2012    9064    Diopside     12/m1       X||a*, Y||b*, Z||c
 
 boundary segments: 148741
 triple points: 12065
 
 Properties: GOS, meanRotation
 
 
ebsd = EBSD  
 
 Phase  Orientations     Mineral        Color  Symmetry  Crystal reference frame
     0   58485 (24%)  notIndexed                                                
     1  152345 (62%)  Forsterite   light blue       mmm                         
     2   26058 (11%)   Enstatite  light green       mmm                         
     3   9064 (3.7%)    Diopside    light red     12/m1       X||a*, Y||b*, Z||c
 
 Properties: bands, bc, bs, error, mad, x, y, grainId
 Scan unit : um
 
</pre><p>We observe that there are not only grains of specific phases but also not indexed grains. Let's add the grain boundaries to the previous plot.</p><pre class="codeinput">hold <span class="string">on</span>
plot(grains.boundary)
hold <span class="string">off</span>
</pre>
  {% include inline_image.html file="script_ShapeParameters_02.png" %}
<p>The resulting grains contain a lot of holes and one-pixel grains. The second way is to assign not indexed pixels to surrounding grains. In MTEX this is done if the not indexed data are removed from the measurements, i.e.</p><pre class="codeinput">ebsd = ebsd(<span class="string">'indexed'</span>) <span class="comment">% this removes all not indexed data</span>
[grains, ebsd.grainId] = calcGrains(ebsd,<span class="string">'angle'</span>,5*degree)
</pre><pre class="codeoutput"> 
ebsd = EBSD  
 
 Phase  Orientations     Mineral        Color  Symmetry  Crystal reference frame
     1  152345 (81%)  Forsterite   light blue       mmm                         
     2   26058 (14%)   Enstatite  light green       mmm                         
     3   9064 (4.8%)    Diopside    light red     12/m1       X||a*, Y||b*, Z||c
 
 Properties: bands, bc, bs, error, mad, x, y, grainId
 Scan unit : um
 
 
grains = grain2d  
 
 Phase  Grains  Pixels     Mineral  Symmetry  Crystal reference frame
     1    1256  152345  Forsterite       mmm                         
     2     518   26058   Enstatite       mmm                         
     3    1526    9064    Diopside     12/m1       X||a*, Y||b*, Z||c
 
 boundary segments: 45832
 triple points: 3863
 
 Properties: GOS, meanRotation
 
 
ebsd = EBSD  
 
 Phase  Orientations     Mineral        Color  Symmetry  Crystal reference frame
     1  152345 (81%)  Forsterite   light blue       mmm                         
     2   26058 (14%)   Enstatite  light green       mmm                         
     3   9064 (4.8%)    Diopside    light red     12/m1       X||a*, Y||b*, Z||c
 
 Properties: bands, bc, bs, error, mad, x, y, grainId
 Scan unit : um
 
</pre><p>Now, there are no not indexed grains computed. Let's visualize the result</p><pre class="codeinput"><span class="comment">% plot the orientation data of the Forsterite phase</span>
plot(ebsd(<span class="string">'fo'</span>),ebsd(<span class="string">'fo'</span>).orientations)

<span class="comment">% plot the grain boundary on top of it</span>
hold <span class="string">on</span>
plot(grains.boundary)
hold <span class="string">off</span>


<span class="comment">% smooth the grains</span>
grains = smooth(grains);

<span class="comment">% plot the orientation data of the Forsterite phase</span>
plot(ebsd(<span class="string">'fo'</span>),ebsd(<span class="string">'fo'</span>).orientations)

<span class="comment">% plot the grain boundary on top of it</span>
hold <span class="string">on</span>
plot(grains.boundary)
hold <span class="string">off</span>
</pre>
  {% include inline_image.html file="script_ShapeParameters_03.png" %}
<h2 id="7">Area, Perimeter, Diameter</h2><h2 id="8">Holes</h2><h2 id="9">Neighbours</h2><h2 id="10">Fitted Ellipse</h2><h2 id="12">Convexity</h2><p>pari</p><h2 id="13">Grain properties</h2><p>Grains are stored as a long list of several properties. Please find below a table of most of the properties that are stored or can be computed for grains</p><p>
   <table class="usertable">
      <tr>
         <td>
               <p>
                  <a href="grain2d.area.html">
                     <b>grains.area</b>
                  </a>
               </p>
         </td>
         <td>
               <p>grain area in square <a href="grain2d.index.html">grains.scanUnit</a>
               </p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.aspectRatio.html">
                     <b>grains.aspectRatio</b>
                  </a>
               </p>
         </td>
         <td>
               <p>grain length / grain width</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grainBoundary.html">
                     <b>grains.boundary</b>
                  </a>
               </p>
         </td>
         <td>
               <p>list of boundary segments</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.boundarySize.html">
                     <b>grains.boundarySize</b>
                  </a>
               </p>
         </td>
         <td>
               <p>number of boundary segments</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.paris.html">
                     <b>grains.paris</b>
                  </a>
               </p>
         </td>
         <td>
               <p>area difference between grain and its convex hull</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.centroid.html">
                     <b>grains.centroid</b>
                  </a>
               </p>
         </td>
         <td>
               <p>x,y coordinates of the barycenter of the grain</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <b>grains.CS</b>
               </p>
         </td>
         <td>
               <p>crystal symmetry (single phase only)</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.diameter.html">
                     <b>grains.diameter</b>
                  </a>
               </p>
         </td>
         <td>
               <p>diameter in <a href="grain2d.index.html">grains.scanUnit</a>
               </p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.equivalentPerimeter.html">
                     <b>grains.equivalentPerimeter</b>
                  </a>
               </p>
         </td>
         <td>
               <p>the perimeter of the fitted ellipse</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.equivalentRadius.html">
                     <b>grains.equivalentRadius</b>
                  </a>
               </p>
         </td>
         <td>
               <p>the radius of the fitted ellipse</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <b>grains.GOS</b>
               </p>
         </td>
         <td>
               <p>grain orientation spread</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <b>grains.grainSize</b>
               </p>
         </td>
         <td>
               <p>number of measurements per grain</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.hasHole.html">
                     <b>grains.hasHole</b>
                  </a>
               </p>
         </td>
         <td>
               <p>check for inclusions</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <b>grains.id</b>
               </p>
         </td>
         <td>
               <p>grain id</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grainBoundary.html">
                     <b>grains.innerBoundary</b>
                  </a>
               </p>
         </td>
         <td>
               <p>list of inner boundary segments</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <b>grains.meanOrientation</b>
               </p>
         </td>
         <td>
               <p>meanOrientation (single phase only)</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <b>grains.mineral</b>
               </p>
         </td>
         <td>
               <p>mineral name (single phase only)</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.neigbours.html">
                     <b>grains.neighbours</b>
                  </a>
               </p>
         </td>
         <td>
               <p>number and ids of neighboring grains</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <b>grains.phase</b>
               </p>
         </td>
         <td>
               <p>phase identifier</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.perimeter.html">
                     <b>grains.perimeter</b>
                  </a>
               </p>
         </td>
         <td>
               <p>perimeter in <a href="grain2d.index.html">grains.scanUnit</a>
               </p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.principalComponents.html">
                     <b>grains.principalComponents</b>
                  </a>
               </p>
         </td>
         <td>
               <p>length and width of the fitted ellipse</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="grain2d.shapeFactor.html">
                     <b>grains.shapeFactor</b>
                  </a>
               </p>
         </td>
         <td>
               <p>quotient perimeter / perimeter of the fitted ellipse</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <a href="triplePoints.html">
                     <b>grains.triplePoints</b>
                  </a>
               </p>
         </td>
         <td>
               <p>list of  triple points</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <b>grains.x</b>
               </p>
         </td>
         <td>
               <p>x coordinates of the vertices</p>
         </td>
      </tr>
      <tr>
         <td>
               <p>
                  <b>grains.y</b>
               </p>
         </td>
         <td>
               <p>y coordinates of the vertices</p>
         </td>
      </tr>
   </table>
</p><p>Those grain properties can be used for colorization. E.g. we may colorize grains according to their area.</p><pre class="codeinput">plot(grains,grains.area)
</pre>
  {% include inline_image.html file="script_ShapeParameters_04.png" %}
<p>or a little bit more advanced according to the log quotient between grain size and boundary size.</p><pre class="codeinput">plot(grains,log(grains.grainSize ./ grains.boundarySize))
mtexColorbar
</pre>
  {% include inline_image.html file="script_ShapeParameters_05.png" %}
<p>Note that some properties are available for single phase lists of grains, e.g.</p><pre class="codeinput"><span class="comment">% colorize the Forsterite Phase according to its mean orientation</span>
plot(grains(<span class="string">'Fo'</span>),grains(<span class="string">'Fo'</span>).meanOrientation)
</pre><pre class="codeoutput">  I'm going to colorize the orientation data with the 
  standard MTEX colorkey. To view the colorkey do:
 
  oM = ipfColorKey(ori_variable_name)
  plot(oM)
</pre>
  {% include inline_image.html file="script_ShapeParameters_06.png" %}
<h2 id="17">Changing lists of grains</h2><p>As with any list in MTEX, one can single out specific grains by conditions using the syntax</p><pre class="codeinput"><span class="comment">% this gives all grains with more the 1000 pixels</span>
largeGrains = grains(grains.grainSize &gt; 1000)

hold <span class="string">on</span>
<span class="comment">% mark only large Forsterite grains</span>
plot(largeGrains(<span class="string">'Fo'</span>).boundary,<span class="string">'linewidth'</span>,2,<span class="string">'linecolor'</span>,<span class="string">'k'</span>)
hold <span class="string">off</span>
</pre><pre class="codeoutput"> 
largeGrains = grain2d  
 
 Phase  Grains  Pixels     Mineral  Symmetry  Crystal reference frame
     1      37   58902  Forsterite       mmm                         
     2       1    1038   Enstatite       mmm                         
 
 boundary segments: 10886
 triple points: 816
 
 Properties: GOS, meanRotation
 
</pre>
  {% include inline_image.html file="script_ShapeParameters_07.png" %}
</div></body></html>