---
title: IPF Maps
last_updated: 07-Nov-2019
sidebar: documentation_sidebar
permalink: EBSDIPFMap.html
folder: documentation
toc: false
---
    <html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>IPF Maps</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-11-07"><meta name="DC.source" content="script_EBSDIPFMap.m"></head><body><font size="2"><a href="https://github.com/mtex-toolbox/mtex/blob/develop/doc/EBSDAnalysis/EBSDIPFMap.m">
    edit page</a></font><div><!--introduction--><!--/introduction--><p>This section explains various options to customize ipf orientation maps. The mathematics behind the default MTEX color key is explained in detail in the paper <a href="http://dx.doi.org/10.1107/S1600576716012942">Orientations - perfectly colored</a>. Let us first import some sample EBSD data.</p>
{% highlight matlab %}
close all; plotx2east
mtexdata forsterite
csFo = ebsd('Forsterite').CS;
{% endhighlight %}

{% highlight plaintext %}
ebsd = EBSD  
 
 Phase  Orientations     Mineral         Color  Symmetry  Crystal reference frame
     0   58485 (24%)  notIndexed                                                 
     1  152345 (62%)  Forsterite  LightSkyBlue       mmm                         
     2   26058 (11%)   Enstatite  DarkSeaGreen       mmm                         
     3   9064 (3.7%)    Diopside     Goldenrod     12/m1       X||a*, Y||b*, Z||c
 
 Properties: bands, bc, bs, error, mad, x, y
 Scan unit : um'
{% endhighlight %}
<h2 id="2">The basic setup</h2><p>In order to transform orientations into color one usually defines a <a href="orientationColorKey.html">orientation color key</a> ,e.g,</p>
{% highlight matlab %}
ipfKey = ipfHSVKey(ebsd('Forsterite').CS)
{% endhighlight %}

{% highlight plaintext %}
ipfKey = 
  ipfHSVKey with properties:

             colorPostRotation: [1&times;1 rotation]
               colorStretching: 1
                   whiteCenter: [1&times;1 vector3d]
                     grayValue: [0.2000 0.5000]
                  grayGradient: 0.5000
                      maxAngle: Inf
    inversePoleFigureDirection: [1&times;1 vector3d]
                        dirMap: [1&times;1 HSVDirectionKey]
                           CS1: [4&times;2 crystalSymmetry]
                           CS2: [1&times;1 specimenSymmetry]
                     antipodal: 0'
{% endhighlight %}
<p>Note that a mandatory argument to any color key is always the symmetry of the objects to be transformed into colors. When plotting the color key we see that plotting region automatically adapts to the fundamental sector of orthorhombic crystal symmetry</p>
{% highlight matlab %}
plot(ipfKey)
{% endhighlight %}
<center>
{% include inline_image.html file="EBSDIPFMap_01.png" %}
</center><p>In order to apply this color key for colorizing the map we proceed as follows</p>
{% highlight matlab %}
% compute the colors
color = ipfKey.orientation2color(ebsd('Fo').orientations);

% plot the colors
close all
plot(ebsd('Forsterite'),color)
{% endhighlight %}
<center>
{% include inline_image.html file="EBSDIPFMap_02.png" %}
</center><p>We can also visualize the orientations of the forsterite phase by plotting them into the inverse pole figure map.</p>
{% highlight matlab %}
plotIPDF(ebsd('Forsterite').orientations,color,ipfKey.inversePoleFigureDirection,...
  'MarkerSize',6,'MarkerEdgeColor','k')
{% endhighlight %}

{% highlight plaintext %}
I'm plotting 12500 random orientations out of 152345 given orientations'
{% endhighlight %}
<center>
{% include inline_image.html file="EBSDIPFMap_03.png" %}
</center><h2 id="6">Customizing the color key</h2><p>Orientation color keys usually provide several options to alter the alignment of colors. Let's give some examples</p>
{% highlight matlab %}
% we may interchange green and blue by setting
ipfKey.colorPostRotation = reflection(yvector);

plot(ipfKey)
{% endhighlight %}
<center>
{% include inline_image.html file="EBSDIPFMap_04.png" %}
</center><p>or cycle of colors red, green, blue by</p>
{% highlight matlab %}
ipfKey.colorPostRotation = rotation.byAxisAngle(zvector,120*degree);

plot(ipfKey)
{% endhighlight %}
<center>
{% include inline_image.html file="EBSDIPFMap_05.png" %}
</center><p>Furthermore, we can explicitly set the inverse pole figure directions by</p>
{% highlight matlab %}
ipfKey.inversePoleFigureDirection = zvector;

% compute the colors again
color = ipfKey.orientation2color(ebsd('Forsterite').orientations);

% and plot them
close all
plot(ebsd('Forsterite'),color)
{% endhighlight %}
<center>
{% include inline_image.html file="EBSDIPFMap_06.png" %}
</center><h2 id="9">Laue or Enantiomorphic symmetry groups</h2><p>As the Euler angles provided by the EBSD measurement devices describe proper rotations only they do not include any improper symmetry operation. For this reason it is entirely justified to consider for the ipf map proper symmetries only. Lets define the corresponding color key</p>
{% highlight matlab %}
% the colore key corresponding to the purely enantiomorphic symmetry group
ipfKey = ipfHSVKey(ebsd('Forsterite').CS.properGroup)
plot(ipfKey)
{% endhighlight %}

{% highlight plaintext %}
ipfKey = 
  ipfHSVKey with properties:

             colorPostRotation: [1&times;1 rotation]
               colorStretching: 1
                   whiteCenter: [1&times;1 vector3d]
                     grayValue: [0.2000 0.5000]
                  grayGradient: 0.5000
                      maxAngle: Inf
    inversePoleFigureDirection: [1&times;1 vector3d]
                        dirMap: [1&times;1 HSVDirectionKey]
                           CS1: [4&times;1 crystalSymmetry]
                           CS2: [1&times;1 specimenSymmetry]
                     antipodal: 0'
{% endhighlight %}
<center>
{% include inline_image.html file="EBSDIPFMap_07.png" %}
</center><p>We oberseve that the key is twice as large and hence allows for a better distinction between orientations.</p>
{% highlight matlab %}
close all
color = ipfKey.orientation2color(ebsd('Fo').orientations);
plot(ebsd('Forsterite'),color)
{% endhighlight %}
<center>
{% include inline_image.html file="EBSDIPFMap_08.png" %}
</center><h2 id="11">Other inverse pole figure keys</h2><p>Beside the default ipf color key MTEX provides the default color keys are they are used by other popular EBSD systems.</p>
{% highlight matlab %}
plot(ipfTSLKey(csFo))
{% endhighlight %}
<center>
{% include inline_image.html file="EBSDIPFMap_09.png" %}
</center>
{% highlight matlab %}
plot(ipfHKLKey(csFo))
{% endhighlight %}
<center>
{% include inline_image.html file="EBSDIPFMap_10.png" %}
</center><p>The user should be aware that for certain symmetry groups these color key lead to color jumps.</p><h2 id="14">Other Visualitations of Color Keys</h2><p>We may also look at the inverse pole figure sphere in 3d. One can nicely observe how the color map follows the given symmetry group.</p>
{% highlight matlab %}
close all
plot(ipfKey,'3d')
{% endhighlight %}
<center>
{% include inline_image.html file="EBSDIPFMap_11.png" %}
</center><p>Alternatively, we may plot the color mapping in 2d together with the symmetry elements</p>
{% highlight matlab %}
plot(ipfKey,'complete','upper')

hold on
plot(ipfKey.CS1)
hold off
{% endhighlight %}
<center>
{% include inline_image.html file="EBSDIPFMap_12.png" %}
</center></div></body></html>