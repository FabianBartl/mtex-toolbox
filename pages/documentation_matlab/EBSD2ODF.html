---
title: script_EBSD2ODF
last_updated: 10-Oct-2019
sidebar: documentation_sidebar
permalink: EBSD2ODF.html
folder: documentation
toc: false
---

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>script_EBSD2ODF</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-10-10"><meta name="DC.source" content="script_EBSD2ODF.m"></head><body><font size="2"><a href="#" data-toggle="tooltip" data-original-title="To edit this page type edit EBSD2ODF into the Matlab commandline">edit page</a></font><div><h2 id="1">ODF Estimation from EBSD data</h2><p>In order to discuss ODF estimation from EBSD data we start by loading a sample MTEX data set.s</p>
{% highlight matlab %}
mtexdata forsterite
{% endhighlight %}

{% highlight plaintext %}
 
ebsd = EBSD  
 
 Phase  Orientations     Mineral         Color  Symmetry  Crystal reference frame
     0   58485 (24%)  notIndexed                                                 
     1  152345 (62%)  Forsterite  LightSkyBlue       mmm                         
     2   26058 (11%)   Enstatite  DarkSeaGreen       mmm                         
     3   9064 (3.7%)    Diopside     Goldenrod     12/m1       X||a*, Y||b*, Z||c
 
 Properties: bands, bc, bs, error, mad, x, y
 Scan unit : um
 

{% endhighlight %}
<h2 id="2">ODF Estimation</h2><p>These EBSD datasets consist of two phases, Iron, and Magnesium. The ODF of the Iron phase is computed by the command</p>
{% highlight matlab %}
odf = calcODF(ebsd('fo').orientations)
{% endhighlight %}

{% highlight plaintext %}
 
odf = ODF  
  crystal symmetry : Forsterite (mmm)
  specimen symmetry: 1
 
  Harmonic portion:
    degree: 25
    weight: 1
 

{% endhighlight %}
<p>The function <a href="EBSD.calcODF.html">calcODF</a> implements the ODF estimation from EBSD data in MTEX. The underlying statistical method is called kernel density estimation, which can be seen as a generalized histogram. To be more precise, let's 
  {% include inline_image.html file="EBSD2ODF_eq15027334617265588240.png" %}
 be a radially symmetric, unimodal model ODF. Then the kernel density estimator for the individual orientation data 
  {% include inline_image.html file="EBSD2ODF_eq04809259543156815891.png" %}
 is defined as</p><p>
  {% include inline_image.html file="EBSD2ODF_eq08260128012335872965.png" %}
</p><p>The choice of the model ODF 
  {% include inline_image.html file="EBSD2ODF_eq01982406464486259838.png" %}
 and in particular its halfwidth has a great impact in the resulting ODF. If no halfwidth is specified the default halfwidth of 10 degrees is selected.</p><h2 id="4">Automatic halfwidth selection</h2><p>MTEX includes an automatic halfwidth selection algorithm which is called by the command <a href="EBSD.calcKernel.html">calcKernel</a>. To work properly, this algorithm needs spatially independent EBSD data as in the case of this dataset of very rough EBSD measurements (only one measurement per grain).</p>
{% highlight matlab %}
% try to compute an optimal kernel
psi = calcKernel(ebsd('fo').orientations)
{% endhighlight %}

{% highlight plaintext %}
 
psi = deLaValleePoussinKernel  
  bandwidth: 98
  halfwidth: 2.3&deg;
 

{% endhighlight %}
<p>In the above example, the EBSD measurements are spatial dependent and the resulting halfwidth is too small. To avoid this problem we have to perform grain reconstruction first and then estimate the halfwidth from the grains.</p>
{% highlight matlab %}
% grains reconstruction
grains = calcGrains(ebsd);

% correct for to small grains
grains = grains(grains.grainSize&gt;5);

% compute optimal halfwidth from the meanorientations of grains
psi = calcKernel(grains('fo').meanOrientation)

% compute the ODF with the kernel psi
odf = calcODF(ebsd('fo').orientations,'kernel',psi)
{% endhighlight %}

{% highlight plaintext %}
 
psi = deLaValleePoussinKernel  
  bandwidth: 41
  halfwidth: 6&deg;
 
 
odf = ODF  
  crystal symmetry : Forsterite (mmm)
  specimen symmetry: 1
 
  Harmonic portion:
    degree: 41
    weight: 1
 

{% endhighlight %}
<p>Once an ODF is estimated all the functionality MTEX offers for <a href="ODFCalculations.html">ODF analysis</a> and <a href="ODFPlot.html">ODF visualization</a> is available.</p>
{% highlight matlab %}
h = [Miller(1,0,0,odf.CS),Miller(1,1,0,odf.CS),Miller(1,1,1,odf.CS)];
plotPDF(odf,h,'antipodal','silent')
{% endhighlight %}

  {% include inline_image.html file="EBSD2ODF_01.png" %}
<h2 id="7">Effect of halfwidth selection</h2><p>As mentioned above a proper halfwidth selection is crucial for ODF estimation. The following simple numerical experiment illustrates the dependency between the kernel halfwidth and the estimated error.</p><p>Let's start with a model ODF and simulate some individual orientation data.</p>
{% highlight matlab %}
modelODF = fibreODF(Miller(1,1,1,crystalSymmetry('cubic')),xvector);
ori = calcOrientations(modelODF,10000)
{% endhighlight %}

{% highlight plaintext %}
 
ori = orientation  
  size: 10000 x 1
  crystal symmetry : m-3m
  specimen symmetry: 1
 

{% endhighlight %}
<p>Next we define a list of kernel halfwidth ,</p>
{% highlight matlab %}
hw = [1*degree, 2*degree, 4*degree, 8*degree, 16*degree, 32*degree];
{% endhighlight %}
<p>estimate for each halfwidth an ODF and compare it to the original ODF.</p>
{% highlight matlab %}
e = zeros(size(hw));
for i = 1:length(hw)

  odf = calcODF(ori,'halfwidth',hw(i),'silent');
  e(i) = calcError(modelODF, odf);

end
{% endhighlight %}
<p>After visualizing the estimation error we observe that its value is large either if we choose a very small or a very large halfwidth. In this specific example, the optimal halfwidth seems to be about 4 degrees.</p>
{% highlight matlab %}
close all
plot(hw/degree,e)
xlabel('halfwidth in degree')
ylabel('esimation error')
{% endhighlight %}

  {% include inline_image.html file="EBSD2ODF_02.png" %}
</div></body></html>