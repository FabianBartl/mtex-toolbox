---
title: Bingham Distribution
last_updated: 24-Oct-2019
sidebar: documentation_sidebar
permalink: BinghamODFs.html
folder: documentation
toc: false
---

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Bingham Distribution</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-10-24"><meta name="DC.source" content="script_BinghamODFs.m"></head><body><font size="2"><a href="/documentation/Contribute2Doc.html" data-toggle="tooltip" data-original-title="To edit this page type edit BinghamODFs into the Matlab commandline">edit page</a></font><div><!--introduction--><!--/introduction--><h2 id="1">Theory</h2><p>The Bingham distribution has the density</p><p>
  {% include inline_image.html file="BinghamODFs_eq05340943576548919889.png" %}
</p><p>where 
  {% include inline_image.html file="BinghamODFs_eq02619125812656254059.png" %}
 are an 
  {% include inline_image.html file="BinghamODFs_eq17452142193152507074.png" %}
 orthogonal matrix with unit quaternions 
  {% include inline_image.html file="BinghamODFs_eq16547169682649117252.png" %}
 in the column and 
  {% include inline_image.html file="BinghamODFs_eq03845174387838694102.png" %}
  a 
  {% include inline_image.html file="BinghamODFs_eq17452142193152507074.png" %}
 diagonal matrix with the entries 
  {% include inline_image.html file="BinghamODFs_eq10077891534842131870.png" %}
 describing the shape of the distribution. 
  {% include inline_image.html file="BinghamODFs_eq17454643056377931030.png" %}
 is the hypergeometric function with matrix argument normalizing the density.</p><p>The shape parameters 
  {% include inline_image.html file="BinghamODFs_eq17406183697768129620.png" %}
 give</p><div><ul><li>a <i>bipolar</i>   distribution, if 
  {% include inline_image.html file="BinghamODFs_eq12904346392585024444.png" %}
,</li><li>a <i>circular</i>  distribution, if 
  {% include inline_image.html file="BinghamODFs_eq17959291001473903768.png" %}
,</li><li>a <i>spherical</i> distribution, if 
  {% include inline_image.html file="BinghamODFs_eq07201422564525560515.png" %}
,</li><li>a <i>uniform</i>  distribution, if 
  {% include inline_image.html file="BinghamODFs_eq16083675247562721536.png" %}
,</li></ul></div><p>The general setup of the Bingham distribution in MTEX is done as follows</p>
{% highlight matlab %}
cs = crystalSymmetry('1');

kappa = [100 90 80 0];   % shape parameters
U     = eye(4);          % orthogonal matrix

odf = BinghamODF(kappa,U,cs)
{% endhighlight %}

{% highlight plaintext %}
 
odf = ODF  
  crystal symmetry : 1, X||a, Y||b*, Z||c*
  specimen symmetry: 1
 
  Bingham portion:
     kappa: 100 90 80 0
    weight: 1
 

{% endhighlight %}

{% highlight matlab %}
h = [Miller(0,0,1,cs) Miller(1,0,0,cs) Miller(1,1,1,cs)];
plotPDF(odf,h,'antipodal','silent');


% plot(odf,'sections',10)
{% endhighlight %}
<center>
{% include inline_image.html file="BinghamODFs_01.png" %}
</center><h2 id="4">The bipolar case and unimodal distribution</h2><p>First, we define some unimodal odf</p>
{% highlight matlab %}
odf_spherical = unimodalODF(orientation.id(cs),'halfwidth',20*degree)
{% endhighlight %}

{% highlight plaintext %}
 
odf_spherical = ODF  
  crystal symmetry : 1, X||a, Y||b*, Z||c*
  specimen symmetry: 1
 
  Radially symmetric portion:
    kernel: de la Vallee Poussin, halfwidth 20&deg;
    center: (0&deg;,0&deg;,0&deg;)
    weight: 1
 

{% endhighlight %}

{% highlight matlab %}
plotPDF(odf_spherical,h,'antipodal','silent')
{% endhighlight %}
<center>
{% include inline_image.html file="BinghamODFs_02.png" %}
</center><p>Next, we simulate individual orientations from this odf, in a scattered axis/angle plot in which the simulated data looks like a sphere</p>
{% highlight matlab %}
ori_spherical = calcOrientations(odf_spherical,1000);
close all
scatter(ori_spherical)
{% endhighlight %}
<center>
{% include inline_image.html file="BinghamODFs_03.png" %}
</center><p>From this simulated EBSD data, we can estimate the parameters of the Bingham distribution,</p>
{% highlight matlab %}
calcBinghamODF(ori_spherical)
{% endhighlight %}

{% highlight plaintext %}
 
ans = ODF  
  crystal symmetry : 1, X||a, Y||b*, Z||c*
  specimen symmetry: 1
 
  Bingham portion:
     kappa: 0 2.8 5.1 28
    weight: 1
 

{% endhighlight %}
<p>where <tt>U</tt> is the orthogonal matrix of eigenvectors of the orientation tensor and <tt>kappa</tt> the shape parameters associated with the <tt>U</tt>.</p><p>next, we test the different cases of the distribution on rejection</p>
{% highlight matlab %}
T_spherical = bingham_test(ori_spherical,'spherical','approximated');
T_oblate    = bingham_test(ori_spherical,'prolate',  'approximated');
T_prolate   = bingham_test(ori_spherical,'oblate',   'approximated');

t = [T_spherical T_oblate T_prolate]
{% endhighlight %}

{% highlight plaintext %}
t =
    0.9267    0.7452    0.6830

{% endhighlight %}
<p>The spherical test case failed to reject it for some level of significance, hence we would dismiss the hypothesis prolate and oblate.</p>
{% highlight matlab %}
odf_spherical = BinghamODF(kappa,U,crystalSymmetry,specimenSymmetry)
{% endhighlight %}

{% highlight plaintext %}
 
odf_spherical = ODF  
  crystal symmetry : 1, X||a, Y||b*, Z||c*
  specimen symmetry: 1
 
  Bingham portion:
     kappa: 100 90 80 0
    weight: 1
 

{% endhighlight %}

{% highlight matlab %}
plotPDF(odf_spherical,h,'antipodal','silent')
{% endhighlight %}
<center>
{% include inline_image.html file="BinghamODFs_04.png" %}
</center><h2 id="11">Prolate case and fibre distribution</h2><p>The prolate case correspondes to a fibre.</p>
{% highlight matlab %}
odf_prolate = fibreODF(Miller(0,0,1,crystalSymmetry('1')),zvector,...
  'halfwidth',20*degree)
{% endhighlight %}

{% highlight plaintext %}
 
odf_prolate = ODF  
  crystal symmetry : 1, X||a, Y||b*, Z||c*
  specimen symmetry: 1
 
  Fibre symmetric portion:
    kernel: de la Vallee Poussin, halfwidth 20&deg;
    fibre: (001) - 0,0,1
    weight: 1
 

{% endhighlight %}

{% highlight matlab %}
plotPDF(odf_prolate,h,'upper','silent')
{% endhighlight %}
<center>
{% include inline_image.html file="BinghamODFs_05.png" %}
</center><p>As before, we generate some random orientations from a model odf. The shape in an axis/angle scatter plot reminds of a cigar</p>
{% highlight matlab %}
ori_prolate = calcOrientations(odf_prolate,1000);
close all
scatter(ori_prolate)
{% endhighlight %}
<center>
{% include inline_image.html file="BinghamODFs_06.png" %}
</center><p>We estimate the parameters of the Bingham distribution</p>
{% highlight matlab %}
calcBinghamODF(ori_prolate)
{% endhighlight %}

{% highlight plaintext %}
 
ans = ODF  
  crystal symmetry : 1, X||a, Y||b*, Z||c*
  specimen symmetry: 1
 
  Bingham portion:
     kappa: 0 2.3 52 53
    weight: 1
 

{% endhighlight %}
<p>and test on the three cases</p>
{% highlight matlab %}
T_spherical = bingham_test(ori_prolate,'spherical','approximated');
T_oblate    = bingham_test(ori_prolate,'prolate',  'approximated');
T_prolate   = bingham_test(ori_prolate,'oblate',   'approximated');

t = [T_spherical T_oblate T_prolate]
{% endhighlight %}

{% highlight plaintext %}
t =
    1.0000    0.2130    1.0000

{% endhighlight %}
<p>The test clearly rejects the spherical and prolate case, but not the prolate. We construct the Bingham distribution from the parameters, it might show some skewness</p>
{% highlight matlab %}
odf_prolate = BinghamODF(kappa,U,crystalSymmetry,specimenSymmetry)
{% endhighlight %}

{% highlight plaintext %}
 
odf_prolate = ODF  
  crystal symmetry : 1, X||a, Y||b*, Z||c*
  specimen symmetry: 1
 
  Bingham portion:
     kappa: 100 90 80 0
    weight: 1
 

{% endhighlight %}

{% highlight matlab %}
plotPDF(odf_prolate,h,'antipodal','silent')
{% endhighlight %}
<center>
{% include inline_image.html file="BinghamODFs_07.png" %}
</center><h2 id="18">Oblate case</h2><p>The oblate case of the Bingham distribution has no direct counterpart in terms of texture components, thus we can construct it straightforward</p>
{% highlight matlab %}
odf_oblate = BinghamODF([50 50 50 0],eye(4),crystalSymmetry,specimenSymmetry)
{% endhighlight %}

{% highlight plaintext %}
 
odf_oblate = ODF  
  crystal symmetry : 1, X||a, Y||b*, Z||c*
  specimen symmetry: 1
 
  Bingham portion:
     kappa: 50 50 50 0
    weight: 1
 

{% endhighlight %}

{% highlight matlab %}
plotPDF(odf_oblate,h,'antipodal','silent')
{% endhighlight %}
<center>
{% include inline_image.html file="BinghamODFs_08.png" %}
</center><p>The oblate cases in axis/angle space remind on a disk</p>
{% highlight matlab %}
ori_oblate = calcOrientations(odf_oblate,1000);
close all
scatter(ori_oblate)
{% endhighlight %}
<center>
{% include inline_image.html file="BinghamODFs_09.png" %}
</center><p>We estimate the parameters again</p>
{% highlight matlab %}
calcBinghamODF(ori_oblate)
{% endhighlight %}

{% highlight plaintext %}
 
ans = ODF  
  crystal symmetry : 1, X||a, Y||b*, Z||c*
  specimen symmetry: 1
 
  Bingham portion:
     kappa: 0 47 47 49
    weight: 1
 

{% endhighlight %}
<p>and do the tests</p>
{% highlight matlab %}
T_spherical = bingham_test(ori_oblate,'spherical','approximated');
T_oblate    = bingham_test(ori_oblate,'prolate',  'approximated');
T_prolate   = bingham_test(ori_oblate,'oblate',   'approximated');

t = [T_spherical T_oblate T_prolate]
{% endhighlight %}

{% highlight plaintext %}
t =
    1.0000    1.0000    0.5727

{% endhighlight %}
<p>the spherical and oblate case are clearly rejected, the prolate case failed to reject for some level of significance</p>
{% highlight matlab %}
odf_oblate = BinghamODF(kappa, U,crystalSymmetry,specimenSymmetry)
{% endhighlight %}

{% highlight plaintext %}
 
odf_oblate = ODF  
  crystal symmetry : 1, X||a, Y||b*, Z||c*
  specimen symmetry: 1
 
  Bingham portion:
     kappa: 100 90 80 0
    weight: 1
 

{% endhighlight %}

{% highlight matlab %}
plotPDF(odf_oblate,h,'antipodal','silent')
{% endhighlight %}
<center>
{% include inline_image.html file="BinghamODFs_10.png" %}
</center><p><b>Bingham unimodal ODF</b></p>
{% highlight matlab %}
% a modal orientation
cs = crystalSymmetry('-3m');
mod = orientation.byEuler(45*degree,0*degree,0*degree,cs);

% the corresponding Bingham ODF
odf = BinghamODF(20,mod)

plot(odf,'sections',6,'silent','contourf','sigma')
{% endhighlight %}

{% highlight plaintext %}
 
odf = ODF  
  crystal symmetry : 1, X||a, Y||b*, Z||c*
  specimen symmetry: 1
 
  Bingham portion:
     kappa: 20 0 0 0
    weight: 1
 
Warning: Plot properties not compatible to previous plot!
I'going to create a new figure. 

{% endhighlight %}
<center>
{% include inline_image.html file="BinghamODFs_11.png" %}
</center><p><b>Bingham fibre ODF</b></p>
{% highlight matlab %}
odf = BinghamODF([-10,-10,10,10],quaternion(eye(4)),cs)

plot(odf,'sections',6,'silent','sigma')
{% endhighlight %}

{% highlight plaintext %}
 
odf = ODF  
  crystal symmetry : -3m1, X||a*, Y||b, Z||c*
  specimen symmetry: 1
 
  Bingham portion:
     kappa: -10 -10 10 10
    weight: 1
 
Warning: Plot properties not compatible to previous plot!
I'going to create a new figure. 

{% endhighlight %}
<center>
{% include inline_image.html file="BinghamODFs_12.png" %}
</center><p><b>Bingham spherical ODF</b></p>
{% highlight matlab %}
odf = BinghamODF([-10,10,10,10],quaternion(eye(4)),cs)

plot(odf,'sections',6,'silent','sigma');
{% endhighlight %}

{% highlight plaintext %}
 
odf = ODF  
  crystal symmetry : -3m1, X||a*, Y||b, Z||c*
  specimen symmetry: 1
 
  Bingham portion:
     kappa: -10 10 10 10
    weight: 1
 
Warning: Plot properties not compatible to previous plot!
I'going to create a new figure. 

{% endhighlight %}
<center>
{% include inline_image.html file="BinghamODFs_13.png" %}
</center></div></body></html>