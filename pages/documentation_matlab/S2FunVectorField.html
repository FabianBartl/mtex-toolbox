---
title: S2VectorFieldHarmonic
last_updated: 08-Oct-2019
sidebar: documentation_sidebar
permalink: S2FunVectorField.html
folder: documentation
toc: false
---

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>S2VectorFieldHarmonic</title><meta name="generator" content="MATLAB 9.7"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-10-08"><meta name="DC.source" content="script_S2FunVectorField.m"></head><body><font size="2"><a href="#" data-toggle="tooltip" data-original-title="To edit this page type edit S2FunVectorField into the Matlab commandline">edit page</a></font><div><!--introduction--><p>S2VectorField handles three-dimensional functions on the sphere. For instance the gradient of an univariate S2FunHarmonic can return a S2VectorFieldHarmonic.</p><!--/introduction--><h2 id="1">Contents</h2><h2 id="2">Defining a S2VectorFieldHarmonic</h2><p><b>Definition via function values</b></p><p>At first you need some vertices</p>
  {% highlight matlab %}
  nodes = equispacedS2Grid(<span class="string">'points'</span>, 1e5);
nodes = nodes(:);
  {% endhighlight %}
<p>Next you define function values for the vertices</p>
  {% highlight matlab %}
  y = vector3d.byPolar(sin(3*nodes.theta), nodes.rho+pi/2);
  {% endhighlight %}
<p>Now the actual command to get <tt>sVF1</tt> of type <tt>S2VectorFieldHarmonic</tt></p>
  {% highlight matlab %}
  sVF1 = S2VectorFieldHarmonic.approximation(nodes, y)
  {% endhighlight %}

        {% highlight matlab %}
         
sVF1 = S2VectorFieldHarmonic  
 bandwidth: 128

        {% endhighlight %}
    <p><b>Definition via function handle</b></p><p>If you have a function handle for the function you could create a <tt>S2VectorFieldHarmonic</tt> via quadrature. At first lets define a function handle which takes <a href="vector3d_index.html"><tt>vector3d</tt></a> as an argument and returns also <a href="vector3d_index.html"><tt>vector3d</tt></a>:</p>
  {% highlight matlab %}
  f = @(v) vector3d(v.x, v.y, 0*v.x);
  {% endhighlight %}
<p>Now you can call the quadrature command to get <tt>sVF2</tt> of type <tt>S2VectorFieldHarmonic</tt></p>
  {% highlight matlab %}
  sVF2 = S2VectorFieldHarmonic.quadrature(@(v) f(v))
  {% endhighlight %}

        {% highlight matlab %}
         
sVF2 = S2VectorFieldHarmonic  
 bandwidth: 128

        {% endhighlight %}
    <p><b>Definition via <a href="S2FunHarmonic_index"><tt>S2FunHarmonic</tt></a></b></p><p>If you directly call the constructor with a multivariate <a href="S2FunHarmonic_multi_index"><tt>S2FunHarmonic sF</tt></a> with two or three entries it will create a <tt>S2VectorFieldHarmonic</tt> with <tt>sF(1)</tt> the polar angle and <tt>sF(2)</tt> the azimuth or <tt>sF(1), sF(2)</tt> and <tt>sF(3)</tt> the 
  {% include inline_image.html file="S2FunVectorField_eq09465107182849804810.png" %}
 and 
  {% include inline_image.html file="S2FunVectorField_eq17119888974628994297.png" %}
 component.</p>
  {% highlight matlab %}
  sF = S2FunHarmonic(rand(10, 2));
sVF3 = S2VectorFieldHarmonic(sF)

sF = S2FunHarmonic(rand(10, 3));
sVF4 = S2VectorFieldHarmonic(sF)
  {% endhighlight %}

        {% highlight matlab %}
         
sVF3 = S2VectorFieldHarmonic  
 bandwidth: 3
 
sVF4 = S2VectorFieldHarmonic  
 bandwidth: 3

        {% endhighlight %}
    <h2 id="9">Operations</h2><p><b>Basic arithmetic operations</b></p><p>addition/subtraction</p>
  {% highlight matlab %}
  sVF1+sVF2; sVF1+vector3d(1, 0, 0);
sVF1-sVF2; sVF2-vector3d(sqrt(2)/2, sqrt(2)/2, 0);
  {% endhighlight %}
<p>multiplication/division</p>
  {% highlight matlab %}
  2.*sVF1; sVF1./4;
  {% endhighlight %}
<p>dot product</p>
  {% highlight matlab %}
  dot(sVF1, sVF2); dot(sVF1, vector3d(0, 0, 1));
  {% endhighlight %}
<p>cross product</p>
  {% highlight matlab %}
  cross(sVF1, sVF2); cross(sVF1, vector3d(0, 0, 1));
  {% endhighlight %}
<p><b>Other operations</b></p><p>mean value</p>
  {% highlight matlab %}
  mean(sVF1);
  {% endhighlight %}
<p>Rotation</p>
  {% highlight matlab %}
  r = rotation.byEuler( [pi/4 0 0]);
rotate(sVF1, r);
  {% endhighlight %}
<p>pointwise norm of the vectors</p>
  {% highlight matlab %}
  norm(sVF1);
  {% endhighlight %}
<h2 id="19">Visualization</h2><p>the default <tt>plot</tt>-command</p>
  {% highlight matlab %}
  plot(sVF1);
  {% endhighlight %}

  {% include inline_image.html file="S2FunVectorField_01.png" %}
<div><ul><li>same as quiver(sVF1)</li></ul></div><p>3D plot of a sphere with the vectors on itself</p>
  {% highlight matlab %}
  clf;
quiver3(sVF2);
  {% endhighlight %}

  {% include inline_image.html file="S2FunVectorField_02.png" %}
</div></body></html>