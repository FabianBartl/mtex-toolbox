---
title: Plot seismic wave velocities and polarization directions
last_updated: 04-Apr-2020
sidebar: documentation_sidebar
permalink: CPOSeismicProperties.html
folder: documentation
toc: false
---
    <html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Plot seismic wave velocities and polarization directions</title><meta name="generator" content="MATLAB 9.8"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2020-04-04"><meta name="DC.source" content="script_CPOSeismicProperties.m"></head><body><font size="2"><a href="https://github.com/mtex-toolbox/mtex/blob/develop/doc/Elasticity/CPOSeismicProperties.m">
    edit page</a></font><div><!--introduction--><!--/introduction--><p>In this section we will calculate the elastic properties of an aggregate and plot its seismic properties in pole figures that can be directly compare to the pole figures for CPO</p><p>Let's first import an example dataset from the MTEX toolboox</p>
{% highlight matlab %}
mtexdata forsterite
{% endhighlight %}

{% highlight plaintext %}
ebsd = EBSD  
 
 Phase  Orientations     Mineral         Color  Symmetry  Crystal reference frame
     0   58485 (24%)  notIndexed                                                 
     1  152345 (62%)  Forsterite  LightSkyBlue       mmm                         
     2   26058 (11%)   Enstatite  DarkSeaGreen       mmm                         
     3   9064 (3.7%)    Diopside     Goldenrod     12/m1       X||a*, Y||b*, Z||c
 
 Properties: bands, bc, bs, error, mad, x, y
 Scan unit : um
{% endhighlight %}
<p>This dataset consist of the three main phases, olivine, enstatite and diopside. As we want to plot the seismic properties of this aggregate, we need (i) the modal proportions of each phase in this sample, (ii) their orientations, which is given by their ODFs, (iii) the elastic constants of the minerals and (iv) their densities. One can use the modal proportions that appear in the command window (ol=62 %, en=11%, dio=4%), but there is a lot of non-indexed data. You can recalculate the data only for the indexed data</p><h2 id="3">Correct EBSD spatial coordinates</h2><p>This EBSD dataset has the foliation N-S, but standard CPO plots and physical properties in geosciences use an external reference frame where the foliation is vertical E-W and the lineation is also E-W but horizontal. We can correct the data by rotating the whole dataset by 90 degree around the z-axis</p>
{% highlight matlab %}
ebsd = rotate(ebsd,rotation('axis',-zvector,'angle',90*degree));

plot(ebsd)
{% endhighlight %}
<center>
{% include inline_image.html file="CPOSeismicProperties_01.png" %}
</center><h2 id="4">Import the elastic stiffness tensors</h2><p>The elastic stiffness tensor of Olivine was reported in Abramson et al., 1997 JGR with respect to the crystal reference frame</p>
{% highlight matlab %}
CS_Tensor_olivine = crystalSymmetry('222', [4.762 10.225 5.994],...
    'mineral', 'olivine', 'color', 'light red');
{% endhighlight %}
<p>and the density in g/cm^3</p>
{% highlight matlab %}
rho_olivine = 3.3550;
{% endhighlight %}
<p>by the coefficients \(C_{ij}\) in Voigt matrix notation</p>
{% highlight matlab %}
Cij = [[320.5  68.15  71.6     0     0     0];...
  [ 68.15  196.5  76.8     0     0     0];...
  [  71.6   76.8 233.5     0     0     0];...
  [   0      0      0     64     0     0];...
  [   0      0      0      0    77     0];...
  [   0      0      0      0     0  78.7]];
{% endhighlight %}
<p>In order to define the stiffness tensor as an MTEX variable we use the command <a href="stiffnessTensor.stiffnessTensor.html">stiffnessTensor</a>.</p>
{% highlight matlab %}
C_olivine = stiffnessTensor(Cij,CS_Tensor_olivine,'density',rho_olivine)
{% endhighlight %}

{% highlight plaintext %}
C_olivine = stiffnessTensor  
  density: 3.355            
  unit   : GPa              
  rank   : 4 (3 x 3 x 3 x 3)
  mineral: olivine (222)    
 
  tensor in Voigt matrix representation:
 320.5  68.2  71.6     0     0     0
  68.2 196.5  76.8     0     0     0
  71.6  76.8 233.5     0     0     0
     0     0     0    64     0     0
     0     0     0     0    77     0
     0     0     0     0     0  78.7
{% endhighlight %}
<p>Note that when defining a single crystal tensor we shall always specify the crystal reference system which has been used to represent the tensor by its coordinates \(c_{ijkl}\).</p><p>Analogously, we next define the stiffness tensor of Enstatite and Diopside. For Enstatite we use the coefficients reportet in (Chai et al. 1997 - JGR)</p>
{% highlight matlab %}
% the crystal reference system
cs_Tensor_opx = crystalSymmetry('mmm',[ 18.2457  8.7984  5.1959],...
  [  90.0000  90.0000  90.0000]*degree,'x||a','z||c',...
  'mineral','Enstatite');

% the density
rho_opx = 3.3060;

% the tensor coefficients
Cij =....
  [[  236.90   79.60   63.20    0.00    0.00    0.00];...
  [    79.60  180.50   56.80    0.00    0.00    0.00];...
  [    63.20   56.80  230.40    0.00    0.00    0.00];...
  [     0.00    0.00    0.00   84.30    0.00    0.00];...
  [     0.00    0.00    0.00    0.00   79.40    0.00];...
  [     0.00    0.00    0.00    0.00    0.00   80.10]];

% define the tensor
C_opx = stiffnessTensor(Cij,cs_Tensor_opx,'density',rho_opx)
{% endhighlight %}

{% highlight plaintext %}
C_opx = stiffnessTensor  
  density: 3.306            
  unit   : GPa              
  rank   : 4 (3 x 3 x 3 x 3)
  mineral: Enstatite (mmm)  
 
  tensor in Voigt matrix representation:
 236.9  79.6  63.2     0     0     0
  79.6 180.5  56.8     0     0     0
  63.2  56.8 230.4     0     0     0
     0     0     0  84.3     0     0
     0     0     0     0  79.4     0
     0     0     0     0     0  80.1
{% endhighlight %}
<p>For Diposide coefficients where reported in (Isaak et al., 2005 - PCM)</p>
{% highlight matlab %}
% the crystal reference system
cs_Tensor_cpx = crystalSymmetry('121',[9.585  8.776  5.26],...
  [90.0000 105.8600  90.0000]*degree,'x||a*','z||c',...
  'mineral','Diopside');

% the density
rho_cpx = 3.2860;

% the tensor coefficients
Cij =....
  [[  228.10   78.80   70.20    0.00    7.90    0.00];...
  [    78.80  181.10   61.10    0.00    5.90    0.00];...
  [    70.20   61.10  245.40    0.00   39.70    0.00];...
  [     0.00    0.00    0.00   78.90    0.00    6.40];...
  [     7.90    5.90   39.70    0.00   68.20    0.00];...
  [     0.00    0.00    0.00    6.40    0.00   78.10]];

% define the tensor
C_cpx = stiffnessTensor(Cij,cs_Tensor_cpx,'density',rho_cpx)
{% endhighlight %}

{% highlight plaintext %}
C_cpx = stiffnessTensor  
  density: 3.286                             
  unit   : GPa                               
  rank   : 4 (3 x 3 x 3 x 3)                 
  mineral: Diopside (121, X||a*, Y||b*, Z||c)
 
  tensor in Voigt matrix representation:
 228.1  78.8  70.2     0   7.9     0
  78.8 181.1  61.1     0   5.9     0
  70.2  61.1 245.4     0  39.7     0
     0     0     0  78.9     0   6.4
   7.9   5.9  39.7     0  68.2     0
     0     0     0   6.4     0  78.1
{% endhighlight %}
<h2 id="10">Single crystal seismic velocities</h2><p>The single crystal seismic velocites can be computed by the command <a href="stiffnessTensor.velocity.html"><code class="language-plaintext highlighter-rouge">velocity</code></a> and are explained in more detail <a href="WaveVelocities.html">here</a>. At this point we simply use the command <a href="stiffnessTensor.plotSeismicVelocities.html"><code class="language-plaintext highlighter-rouge">plotSeismicVelocities</code></a> to get an overview of the single crystal seismic properties.</p>
{% highlight matlab %}
plotSeismicVelocities(C_olivine)

% lets add the crystal axes to the second plot
nextAxis(1,2)
hold on
text(Miller({1,0,0},{0,1,0},{0,0,1},CS_Tensor_olivine),...
  {'[100]','[010]','[001]'},'backgroundColor','w')
hold off
{% endhighlight %}
<center>
{% include inline_image.html file="CPOSeismicProperties_02.png" %}
</center><h2 id="11">Bulk elastic tensor from EBSD data</h2><p>Combining the EBSD data and the single crystal stiffness tensors we can estimate an bulk stiffness tensor by computing Voigt, Reuss or Hill averages. Tensor averages are explained in more detail in <a href="TensorAverage.html">this section</a>. Here we use the command <a href="EBSD.calcTensor.html">calcTensor</a></p>
{% highlight matlab %}
[CVoigt, CReuss, CHill] = calcTensor(ebsd,C_olivine,C_opx,C_cpx);
{% endhighlight %}
<p>For visualizing the polycrystal wave velocities we again use the command <a href="stiffnessTensor.plotSeismicVelocities.html"><code class="language-plaintext highlighter-rouge">plotSeismicVelocities</code></a></p>
{% highlight matlab %}
plotSeismicVelocities(CHill)
{% endhighlight %}
<center>
{% include inline_image.html file="CPOSeismicProperties_03.png" %}
</center><h2 id="13">Bulk elastic tensor from ODFs</h2><p>For large data sets the computation of the average stiffness tensor from the EBSD data might be slow. In such cases it can be faster to first estimate an ODF for each individual phase</p>
{% highlight matlab %}
odf_ol = calcDensity(ebsd('f').orientations,'halfwidth',10*degree);
odf_opx = calcDensity(ebsd('e').orientations,'halfwidth',10*degree);
odf_cpx = calcDensity(ebsd('d').orientations,'halfwidth',10*degree);
{% endhighlight %}
<p>Note that you do don't need to write the full name of each phase, only the initial, that works when phases start with different letters.</p><p>To calculate the average stiffness tensor from the ODFs we first compute them from each phase seperately</p>
{% highlight matlab %}
[CVoigt_ol, CReuss_ol, CHill_ol]    = mean(C_olivine,odf_ol);
[CVoigt_opx, CReuss_opx, CHill_opx] = mean(C_opx,odf_opx);
[CVoigt_cpx, CReuss_cpx, CHill_cpx] = mean(C_cpx,odf_cpx);
{% endhighlight %}
<p>and then take their average weighted according the volume of each phase</p>
{% highlight matlab %}
vol_ol  = length(ebsd('f')) ./ length(ebsd('indexed'));
vol_opx = length(ebsd('e')) ./ length(ebsd('indexed'));
vol_cpx = length(ebsd('d')) ./ length(ebsd('indexed'));

CHill = vol_ol * CHill_ol + vol_opx * CHill_opx + vol_cpx * CHill_cpx
{% endhighlight %}

{% highlight plaintext %}
CHill = stiffnessTensor  
  density: 3.355            
  unit   : GPa              
  rank   : 4 (3 x 3 x 3 x 3)
  mineral: olivine (222)    
 
  tensor in Voigt matrix representation:
 238.72  74.05  77.64   0.51   4.38  -2.95
  74.05 209.15  73.42   3.35  -0.51  -1.71
  77.64  73.42 248.59   5.89   4.41  -0.25
   0.51   3.35   5.89  75.83  -0.37   1.62
   4.38  -0.51   4.41  -0.37   83.5   2.03
  -2.95  -1.71  -0.25   1.62   2.03  73.59
{% endhighlight %}
<p>Finaly, we visualize the polycrystal wave velocities as above</p>
{% highlight matlab %}
plotSeismicVelocities(CHill)
{% endhighlight %}
<center>
{% include inline_image.html file="CPOSeismicProperties_04.png" %}
</center></div></body></html>