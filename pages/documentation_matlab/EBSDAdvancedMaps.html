---
title: Advanced Color Keys
last_updated: 10-Oct-2019
sidebar: documentation_sidebar
permalink: EBSDAdvancedMaps.html
folder: documentation
toc: false
---

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Advanced Color Keys</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-10-10"><meta name="DC.source" content="script_EBSDAdvancedMaps.m"></head><body><font size="2"><a href="#" data-toggle="tooltip" data-original-title="To edit this page type edit EBSDAdvancedMaps into the Matlab commandline">edit page</a></font><div><!--introduction--><!--/introduction--><p>Besides the recommended color key <a href="ipfHSVKey.html">ipfHSVKey</a> MTEX includes a bunch of other color keys</p><div><ul><li><a href="ipfTSLKey.html">ipfTSLKey</a></li><li><a href="ipfHKLKey.html">ipfHKLKey</a></li><li><a href="BungeColorKey.html">BungeColorKey</a></li><li><a href="PatalaColorKey.html">PatalaColorKey</a></li><li><a href="axisAngleColorKey.html">axisAngleColorKey</a></li><li><a href="spotColorKey.html">spotColorKey</a></li><li><a href="ipfSpotKey.html">ipfSpotKey</a></li></ul></div>
{% highlight matlab %}
close all; plotx2east
mtexdata forsterite
csFo = ebsd('Forsterite').CS;
{% endhighlight %}

{% highlight plaintext %}
 
ebsd = EBSD  
 
 Phase  Orientations     Mineral         Color  Symmetry  Crystal reference frame
     0   58485 (24%)  notIndexed                                                 
     1  152345 (62%)  Forsterite  LightSkyBlue       mmm                         
     2   26058 (11%)   Enstatite  DarkSeaGreen       mmm                         
     3   9064 (3.7%)    Diopside     Goldenrod     12/m1       X||a*, Y||b*, Z||c
 
 Properties: bands, bc, bs, error, mad, x, y
 Scan unit : um
 

{% endhighlight %}
<h2 id="2">Euler Angle Coloring</h2><p>The oldest way to colorize orientations is to simply map the three Euler angles into the RGB values. This can be done by</p>
{% highlight matlab %}
colorKey = BungeColorKey(csFo);

plot(ebsd('fo'),colorKey.orientation2color(ebsd('fo').orientations))
{% endhighlight %}

  {% include inline_image.html file="EBSDAdvancedMaps_01.png" %}

{% highlight matlab %}
plot(colorKey)
{% endhighlight %}

  {% include inline_image.html file="EBSDAdvancedMaps_02.png" %}
<h2 id="4">Coloring certain orientations</h2><p>We might be interested in locating some special orientation in our orientation map. The definition of colors for certain orientations is carried out similarly as in the case of fibres</p>
{% highlight matlab %}
colorKey = spotColorKey(ebsd('Fo'));
colorKey.center = mean(ebsd('Forsterite').orientations,'robust');
colorKey.color = [0,0,1];
colorKey.psi = deLaValleePoussinKernel('halfwidth',20*degree);

plot(ebsd('fo'),colorKey.orientation2color(ebsd('fo').orientations))

% and the correspoding colormap
figure(2)
plot(colorKey,'sections',9,'sigma')
{% endhighlight %}

  {% include inline_image.html file="EBSDAdvancedMaps_03.png" %}

  {% include inline_image.html file="EBSDAdvancedMaps_04.png" %}
<p>the area of the colored EBSD data in the map corresponds to the volume portion (in percent)</p>
{% highlight matlab %}
vol = 100 * volume(ebsd('fo').orientations,colorKey.center,20*degree)
{% endhighlight %}

{% highlight plaintext %}
vol =
    1.3227

{% endhighlight %}
<p>actually, the colored measurements stress a peak in the ODF</p>
{% highlight matlab %}
close all
odf = calcODF(ebsd('fo').orientations,'halfwidth',10*degree,'silent');
plot(odf,'sections',9,'silent','sigma')
mtexColorbar
{% endhighlight %}

{% highlight plaintext %}
Warning: Plot properties not compatible to previous plot! I'going to create a
new figure. 

{% endhighlight %}

  {% include inline_image.html file="EBSDAdvancedMaps_05.png" %}
<h2 id="7">Coloring fibres</h2><p>To color a fibre, one has to specify the crystal direction <b>h</b> together with its RGB color and the specimen direction <b>r</b>, which should be marked.</p>
{% highlight matlab %}
% define a fibre
f = fibre(Miller(1,1,1,csFo),zvector);

% set up coloring
colorKey = ipfSpotKey(csFo);
colorKey.inversePoleFigureDirection = f.r;
colorKey.center = f.h;
colorKey.color = [0 0 1];
colorKey.psi = deLaValleePoussinKernel('halfwidth',7.5*degree);

plot(ebsd('fo'),colorKey.orientation2color(ebsd('fo').orientations))
{% endhighlight %}

  {% include inline_image.html file="EBSDAdvancedMaps_06.png" %}
<p>the option <tt>halfwidth</tt> controls half of the intensity of the color at a given distance. Here we have chosen the (111)[001] fibre to be drawn in blue, and at 7.5 degrees, where the blue should be only lighter.</p>
{% highlight matlab %}
plot(colorKey)
hold on
circle(f.h.project2FundamentalRegion,15*degree,'linewidth',2)
{% endhighlight %}

  {% include inline_image.html file="EBSDAdvancedMaps_07.png" %}
<p>the percentage of blue colored area in the map is equivalent to the fibre volume</p>
{% highlight matlab %}
vol = volume(ebsd('fo').orientations,f,15*degree)

plotIPDF(ebsd('fo').orientations,zvector,'markercolor','k','marker','x','points',200)
hold off
{% endhighlight %}

{% highlight plaintext %}
vol =
    0.2480
  I'm plotting 200 random orientations out of 152345 given orientations

{% endhighlight %}

  {% include inline_image.html file="EBSDAdvancedMaps_08.png" %}
<p>we can easily extend the colorcoding</p>
{% highlight matlab %}
% the centers in the inverse pole figure
colorKey.center = Miller({0 0 1},{0 1 1},{1 1 1},{11 4 4},{5 0 2},{5 5 2},csFo);

% the correspnding collors
colorKey.color = [[1 0 0];[0 1 0];[0 0 1];[1 0 1];[1 1 0];[0 1 1]];

% plot the key
plot(colorKey)
hold on
plot(ebsd('fo').orientations,'MarkerFaceColor','none','MarkerEdgeColor','k','MarkerSize',3,'points',1000)
hold off
{% endhighlight %}

{% highlight plaintext %}
  I'm plotting 1000 random orientations out of 152345 given orientations

{% endhighlight %}

  {% include inline_image.html file="EBSDAdvancedMaps_09.png" %}

{% highlight matlab %}
close all;
plot(ebsd('fo'),colorKey.orientation2color(ebsd('fo').orientations))
{% endhighlight %}

  {% include inline_image.html file="EBSDAdvancedMaps_10.png" %}
<h2 id="12">Combining different plots</h2><p>Combining different plots can be done either by plotting only subsets of the EBSD data or via the option <tt>'faceAlpha'</tt>. Note that the option <tt>'faceAlpha'</tt> requires the renderer of the figure to be set to <tt>'opengl'</tt>.</p>
{% highlight matlab %}
close all;
plot(ebsd,ebsd.bc,'micronbar','off')
mtexColorMap black2white

colorKey = ipfSpotKey(csFo);
colorKey.inversePoleFigureDirection = zvector;
colorKey.center = Miller(1,1,1,csFo);
colorKey.color = [0 0 1];
colorKey.psi = deLaValleePoussinKernel('halfwidth',7.5*degree);

hold on
plot(ebsd('fo'),colorKey.orientation2color(ebsd('fo').orientations),'FaceAlpha',0.5)
hold off
{% endhighlight %}

  {% include inline_image.html file="EBSDAdvancedMaps_11.png" %}
</div></body></html>