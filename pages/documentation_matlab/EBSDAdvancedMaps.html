---
title: Advanced Color Keys
last_updated: 07-Oct-2019
sidebar: documentation_sidebar
permalink: EBSDAdvancedMaps.html
folder: documentation
toc: false
---

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Advanced Color Keys</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-10-06"><meta name="DC.source" content="script_EBSDAdvancedMaps.m"></head><body><font size="2"><a href="#" data-toggle="tooltip" data-original-title="To edit this page type edit EBSDAdvancedMaps into the Matlab commandline">edit page</a></font><div><!--introduction--><!--/introduction--><p>Besides the recommended color key <a href="ipfHSVKey.html">ipfHSVKey</a> MTEX includes a bunch of other color keys</p><div><ul><li><a href="ipfTSLKey.html">ipfTSLKey</a></li><li><a href="ipfHKLKey.html">ipfHKLKey</a></li><li><a href="BungeColorKey.html">BungeColorKey</a></li><li><a href="PatalaColorKey.html">PatalaColorKey</a></li><li><a href="axisAngleColorKey.html">axisAngleColorKey</a></li><li><a href="spotColorKey.html">spotColorKey</a></li><li><a href="ipfSpotKey.html">ipfSpotKey</a></li></ul></div><pre class="codeinput">close <span class="string">all</span>; plotx2east
mtexdata <span class="string">forsterite</span>
csFo = ebsd(<span class="string">'Forsterite'</span>).CS;
</pre><pre class="codeoutput"> 
ebsd = EBSD  
 
 Phase  Orientations     Mineral         Color  Symmetry  Crystal reference frame
     0   58485 (24%)  notIndexed                                                 
     1  152345 (62%)  Forsterite  LightSkyBlue       mmm                         
     2   26058 (11%)   Enstatite  DarkSeaGreen       mmm                         
     3   9064 (3.7%)    Diopside     Goldenrod     12/m1       X||a*, Y||b*, Z||c
 
 Properties: bands, bc, bs, error, mad, x, y
 Scan unit : um
 
</pre><h2 id="2">Euler Angle Coloring</h2><p>The oldest way to colorize orientations is to simply map the three Euler angles into the RGB values. This can be done by</p><pre class="codeinput">colorKey = BungeColorKey(csFo);

plot(ebsd(<span class="string">'fo'</span>),colorKey.orientation2color(ebsd(<span class="string">'fo'</span>).orientations))
</pre>
  {% include inline_image.html file="EBSDAdvancedMaps_01.png" %}
<pre class="codeinput">plot(colorKey)
</pre>
  {% include inline_image.html file="EBSDAdvancedMaps_02.png" %}
<h2 id="4">Coloring certain orientations</h2><p>We might be interested in locating some special orientation in our orientation map. The definition of colors for certain orientations is carried out similarly as in the case of fibres</p><pre class="codeinput">colorKey = spotColorKey(ebsd(<span class="string">'Fo'</span>));
colorKey.center = mean(ebsd(<span class="string">'Forsterite'</span>).orientations,<span class="string">'robust'</span>);
colorKey.color = [0,0,1];
colorKey.psi = deLaValleePoussinKernel(<span class="string">'halfwidth'</span>,20*degree);

plot(ebsd(<span class="string">'fo'</span>),colorKey.orientation2color(ebsd(<span class="string">'fo'</span>).orientations))

<span class="comment">% and the correspoding colormap</span>
figure(2)
plot(colorKey,<span class="string">'sections'</span>,9,<span class="string">'sigma'</span>)
</pre>
  {% include inline_image.html file="EBSDAdvancedMaps_03.png" %}

  {% include inline_image.html file="EBSDAdvancedMaps_04.png" %}
<p>the area of the colored EBSD data in the map corresponds to the volume portion (in percent)</p><pre class="codeinput">vol = 100 * volume(ebsd(<span class="string">'fo'</span>).orientations,colorKey.center,20*degree)
</pre><pre class="codeoutput">vol =
    1.3227
</pre><p>actually, the colored measurements stress a peak in the ODF</p><pre class="codeinput">close <span class="string">all</span>
odf = calcODF(ebsd(<span class="string">'fo'</span>).orientations,<span class="string">'halfwidth'</span>,10*degree,<span class="string">'silent'</span>);
plot(odf,<span class="string">'sections'</span>,9,<span class="string">'silent'</span>,<span class="string">'sigma'</span>)
mtexColorbar
</pre><pre class="codeoutput">Warning: Plot properties not compatible to previous plot! I'going to create a
new figure. 
</pre>
  {% include inline_image.html file="EBSDAdvancedMaps_05.png" %}
<h2 id="7">Coloring fibres</h2><p>To color a fibre, one has to specify the crystal direction <b>h</b> together with its RGB color and the specimen direction <b>r</b>, which should be marked.</p><pre class="codeinput"><span class="comment">% define a fibre</span>
f = fibre(Miller(1,1,1,csFo),zvector);

<span class="comment">% set up coloring</span>
colorKey = ipfSpotKey(csFo);
colorKey.inversePoleFigureDirection = f.r;
colorKey.center = f.h;
colorKey.color = [0 0 1];
colorKey.psi = deLaValleePoussinKernel(<span class="string">'halfwidth'</span>,7.5*degree);

plot(ebsd(<span class="string">'fo'</span>),colorKey.orientation2color(ebsd(<span class="string">'fo'</span>).orientations))
</pre>
  {% include inline_image.html file="EBSDAdvancedMaps_06.png" %}
<p>the option <tt>halfwidth</tt> controls half of the intensity of the color at a given distance. Here we have chosen the (111)[001] fibre to be drawn in blue, and at 7.5 degrees, where the blue should be only lighter.</p><pre class="codeinput">plot(colorKey)
hold <span class="string">on</span>
circle(f.h.project2FundamentalRegion,15*degree,<span class="string">'linewidth'</span>,2)
</pre>
  {% include inline_image.html file="EBSDAdvancedMaps_07.png" %}
<p>the percentage of blue colored area in the map is equivalent to the fibre volume</p><pre class="codeinput">vol = volume(ebsd(<span class="string">'fo'</span>).orientations,f,15*degree)

plotIPDF(ebsd(<span class="string">'fo'</span>).orientations,zvector,<span class="string">'markercolor'</span>,<span class="string">'k'</span>,<span class="string">'marker'</span>,<span class="string">'x'</span>,<span class="string">'points'</span>,200)
hold <span class="string">off</span>
</pre><pre class="codeoutput">vol =
    0.2480
  I'm plotting 200 random orientations out of 152345 given orientations
</pre>
  {% include inline_image.html file="EBSDAdvancedMaps_08.png" %}
<p>we can easily extend the colorcoding</p><pre class="codeinput"><span class="comment">% the centers in the inverse pole figure</span>
colorKey.center = Miller({0 0 1},{0 1 1},{1 1 1},{11 4 4},{5 0 2},{5 5 2},csFo);

<span class="comment">% the correspnding collors</span>
colorKey.color = [[1 0 0];[0 1 0];[0 0 1];[1 0 1];[1 1 0];[0 1 1]];

<span class="comment">% plot the key</span>
plot(colorKey)
hold <span class="string">on</span>
plot(ebsd(<span class="string">'fo'</span>).orientations,<span class="string">'MarkerFaceColor'</span>,<span class="string">'none'</span>,<span class="string">'MarkerEdgeColor'</span>,<span class="string">'k'</span>,<span class="string">'MarkerSize'</span>,3,<span class="string">'points'</span>,1000)
hold <span class="string">off</span>
</pre><pre class="codeoutput">  I'm plotting 1000 random orientations out of 152345 given orientations
</pre>
  {% include inline_image.html file="EBSDAdvancedMaps_09.png" %}
<pre class="codeinput">close <span class="string">all</span>;
plot(ebsd(<span class="string">'fo'</span>),colorKey.orientation2color(ebsd(<span class="string">'fo'</span>).orientations))
</pre>
  {% include inline_image.html file="EBSDAdvancedMaps_10.png" %}
<h2 id="12">Combining different plots</h2><p>Combining different plots can be done either by plotting only subsets of the EBSD data or via the option <tt>'faceAlpha'</tt>. Note that the option <tt>'faceAlpha'</tt> requires the renderer of the figure to be set to <tt>'opengl'</tt>.</p><pre class="codeinput">close <span class="string">all</span>;
plot(ebsd,ebsd.bc,<span class="string">'micronbar'</span>,<span class="string">'off'</span>)
mtexColorMap <span class="string">black2white</span>

colorKey = ipfSpotKey(csFo);
colorKey.inversePoleFigureDirection = zvector;
colorKey.center = Miller(1,1,1,csFo);
colorKey.color = [0 0 1];
colorKey.psi = deLaValleePoussinKernel(<span class="string">'halfwidth'</span>,7.5*degree);

hold <span class="string">on</span>
plot(ebsd(<span class="string">'fo'</span>),colorKey.orientation2color(ebsd(<span class="string">'fo'</span>).orientations),<span class="string">'FaceAlpha'</span>,0.5)
hold <span class="string">off</span>
</pre>
  {% include inline_image.html file="EBSDAdvancedMaps_11.png" %}
</div></body></html>