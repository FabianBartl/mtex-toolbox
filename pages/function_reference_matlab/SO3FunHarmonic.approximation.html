---
title: approximation

sidebar: function_reference_sidebar
permalink: SO3FunHarmonic.approximation.html
folder: function_reference
toc: false
---
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
    -->
<title>approximation</title>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.source" content="script_SO3FunHarmonic__approximation.m">
</head>
<body>
<font size="2"><a href="https://github.com/mtex-toolbox/mtex/blob/develop/SO3Fun/@SO3FunHarmonic/approximation.m">
    edit page</a></font>
<div>
<!--introduction-->
<!--/introduction-->
<p>approximate an SO3FunHarmonic by given function values at given nodes w.r.t. some noise.</p>
<p>For \(M\) given orientations \(R_i\) and corresponding function values \(y_i\) we compute the SO3FunHarmonic \(f\) of an specific bandwidth which minimizes the least squares problem</p>
<p>\[\sum_{i=1}^M|f(R_i)-y_i|^2.\]</p>
<p>If the oversampling factor is small (high bandwidth) it may be necessary to assure decay of the harmonic coefficients. Therefore we regularize the least squares problem by the Sobolev norm of f, i.e we minimize</p>
<p>\[\sum_{i=1}^M|f(R_i)-y_i|^2 + \lambda \|f\|^2_{H^s}\]</p>
<p>where \(\lambda\) is the regularization parameter and \(s\) the Sobolev index. The Sobolev norm of an SO3FunHarmonic with harmonic coefficients \(\hat{f}\) reads as</p>
<p>\[\|f\|^2_{H^s} = \sum_{n=0}^N (2n+1)^{2s} \, \sum_{k,l=-n}^n|\hat{f}_n^{k,l}|^2.\]</p>
<h2 id="3">Syntax</h2>
{% highlight matlab %}
SO3F = SO3FunHarmonic.approximation(SO3Grid, f)
SO3F = SO3FunHarmonic.approximation(SO3Grid, f,'constantWeights')
SO3F = SO3FunHarmonic.approximation(SO3Grid, f, 'bandwidth', bandwidth, 'tol', TOL, 'maxit', MAXIT, 'weights', W)
SO3F = SO3FunHarmonic.approximation(SO3Grid, f, 'regularization')
SO3F = SO3FunHarmonic.approximation(SO3Grid, f, 'regularization',0.1,'SobolevIndex',1)
{% endhighlight %}
<h2 id="4">Input</h2>
<p>
   <table cellpadding="4" cellspacing="0" class="funcref" width="100%">
      <tr>
         <td width="100px">
            <tt>SO3Grid</tt>
         </td>
         <td>
            <tt>rotational grid</tt>
         </td>
      </tr>
      <tr>
         <td width="100px">
            <tt>f</tt>
         </td>
         <td>
            <tt>function values on the grid (maybe multidimensional)</tt>
         </td>
      </tr>
   </table>
</p>
<h2 id="5">Options</h2>
<p>
   <table cellpadding="4" cellspacing="0" class="funcref" width="100%">
      <tr>
         <td width="100px">
            <tt>constantWeights</tt>
         </td>
         <td>
            <tt>uses constant normalized weights (for example if the nodes are constructed by equispacedSO3Grid)</tt>
         </td>
      </tr>
      <tr>
         <td width="100px">
            <tt>weights</tt>
         </td>
         <td>
            <tt>weight w_n for the nodes (default: Voronoi weights)</tt>
         </td>
      </tr>
      <tr>
         <td width="100px">
            <tt>bandwidth</tt>
         </td>
         <td>
            <tt>maximum degree of the Wigner-D functions used to approximate the function (Be careful by setting the bandwidth by yourself, since it may yields undersampling)</tt>
         </td>
      </tr>
      <tr>
         <td width="100px">
            <tt>tol</tt>
         </td>
         <td>
            <tt>tolerance for lsqr</tt>
         </td>
      </tr>
      <tr>
         <td width="100px">
            <tt>maxit</tt>
         </td>
         <td>
            <tt>maximum number of iterations for lsqr</tt>
         </td>
      </tr>
      <tr>
         <td width="100px">
            <tt>regularization</tt>
         </td>
         <td>
            <tt>the energy functional of the lsqr solver is regularized by the Sobolev norm of SO3F (there is given a regularization constant)</tt>
         </td>
      </tr>
      <tr>
         <td width="100px">
            <tt>SobolevIndex</tt>
         </td>
         <td>
            <tt>for regularization (default = 2)</tt>
         </td>
      </tr>
   </table>
</p>
<h2 id="6">See also</h2>
<p>
<a href="SO3Fun.interpolate.html">SO3Fun.interpolate</a> <a href="SO3FunHarmonic.quadrature.html">SO3FunHarmonic.quadrature</a> <a href="SO3VectorFieldHarmonic.approximation.html">SO3VectorFieldHarmonic.approximation</a>
</p>
</div>
</body>
</html>
